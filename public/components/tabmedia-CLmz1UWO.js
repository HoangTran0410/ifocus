import{r as n,j as e,f as b,U as q,o as B,M as w,X as k,g as G,p as J,V as K,q as Q,H as Z,s as ee}from"../vendor-DqyeD3wz.js";import{w as j,H as te,y as se,z as ie}from"../index-Dc8UlBpp.js";function ne(){const[a,c]=j("zen_yt_url",""),[r,z]=j("zen_yt_history",[]),[m,v]=n.useState(a),[i,U]=n.useState(null),[u,P]=j("zen_media_loop",!0),[y,o]=n.useState(!1),[x,I]=j("zen_media_volume",.7),[p,C]=n.useState(!1),[S,f]=n.useState(0),[M,g]=n.useState(0),l=n.useRef(null),N=n.useRef(null);n.useEffect(()=>{l.current&&(l.current.volume=p?0:x)},[x,p]);const E=t=>{var d;const s=(d=t.target.files)==null?void 0:d[0];if(s){i!=null&&i.url.startsWith("blob:")&&URL.revokeObjectURL(i.url);const A=URL.createObjectURL(s),W=s.type.startsWith("video/"),X={id:`media-${Date.now()}`,name:s.name,type:W?"video":"audio",url:A,timestamp:Date.now()};U(X),o(!1),f(0),g(0)}N.current&&(N.current.value="")},H=()=>{l.current&&(y?l.current.pause():l.current.play().catch(console.error),o(!y))},L=()=>{l.current&&f(l.current.currentTime)},R=()=>{l.current&&(g(l.current.duration),se("uploaded-media")||ie("uploaded-media",l.current).catch(()=>{}))},_=t=>{const s=parseFloat(t.target.value);l.current&&(l.current.currentTime=s,f(s))},$=t=>{const s=parseFloat(t.target.value);I(s),p&&s>0&&C(!1)},T=t=>{if(!isFinite(t))return"0:00";const s=Math.floor(t/60),d=Math.floor(t%60);return`${s}:${d.toString().padStart(2,"0")}`},F=()=>{i!=null&&i.url.startsWith("blob:")&&URL.revokeObjectURL(i.url),U(null),o(!1),f(0),g(0)},V=t=>{const s=[t,...r.filter(d=>d!==t)].slice(0,5);z(s)},D=t=>{z(r.filter(s=>s!==t))},O=t=>{t.preventDefault(),m&&(c(m),V(m))},Y=t=>{v(t),c(t)},h=n.useMemo(()=>ae(a),[a]);return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("form",{onSubmit:O,className:"space-y-2",children:[e.jsx("label",{className:"text-xs text-white/70 uppercase tracking-wider",children:"Media URL"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:m,onChange:t=>v(t.target.value),placeholder:"YouTube, Spotify, Apple Music...",className:"w-full bg-white/5 border border-white/10 rounded-lg px-3 py-2 text-sm focus:outline-none focus:border-white/50 transition-colors"}),e.jsx("button",{type:"submit",className:"bg-white/10 text-white p-2 rounded-lg hover:bg-white/20",children:e.jsx(b,{size:18})})]})]}),e.jsx("div",{className:"text-xs text-white/30 leading-relaxed",children:"Supports YouTube videos, Spotify tracks/playlists, and Apple Music albums. Paste the link and we'll handle the embed."}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"p-3 rounded-xl bg-white/5 border border-white/10 cursor-pointer hover:bg-white/10 transition-all flex items-center gap-3",children:[e.jsx("input",{ref:N,type:"file",className:"hidden",accept:"audio/*,video/*",onChange:E}),e.jsx(q,{size:18,className:"text-white/50"}),e.jsx("span",{className:"text-xs text-white/70 font-medium",children:"Upload from device"})]}),i&&i.url&&e.jsxs("div",{className:"bg-white/5 rounded-xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-white/10",children:[e.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[i.type==="video"?e.jsx(B,{size:16,className:"text-purple-400 shrink-0"}):e.jsx(w,{size:16,className:"text-blue-400 shrink-0"}),e.jsx("span",{className:"text-sm font-medium truncate",children:i.name})]}),e.jsx("button",{onClick:F,className:"p-1 text-white/50 hover:text-white hover:bg-white/10 rounded transition-all shrink-0",title:"Close player",children:e.jsx(k,{size:16})})]}),e.jsx("div",{className:"relative",children:i.type==="video"?e.jsx("video",{ref:l,src:i.url,className:"w-full aspect-video bg-black",onTimeUpdate:L,onLoadedMetadata:R,onEnded:()=>!u&&o(!1),onPlay:()=>o(!0),onPause:()=>o(!1),playsInline:!0,loop:u}):e.jsxs("div",{className:"p-6 flex items-center justify-center bg-gradient-to-br from-blue-500/20 to-purple-500/20",children:[e.jsx("audio",{ref:l,src:i.url,onTimeUpdate:L,onLoadedMetadata:R,onEnded:()=>!u&&o(!1),onPlay:()=>o(!0),onPause:()=>o(!1),loop:u}),e.jsx("div",{className:"w-20 h-20 rounded-full bg-white/10 flex items-center justify-center",children:e.jsx(w,{size:32,className:"text-white/60"})})]})}),e.jsxs("div",{className:"p-3 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-white/50 w-10 text-right",children:T(S)}),e.jsx("input",{type:"range",min:"0",max:M||0,step:"0.1",value:S,onChange:_,className:"flex-1 h-1 rounded-lg appearance-none cursor-pointer bg-white/20 accent-white"}),e.jsx("span",{className:"text-xs text-white/50 w-10",children:T(M)})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:H,className:"w-10 h-10 rounded-full bg-white/10 hover:bg-white/20 flex items-center justify-center transition-all",children:y?e.jsx(G,{size:18}):e.jsx(b,{size:18,className:"ml-0.5"})}),e.jsx("button",{onClick:()=>C(!p),className:"p-2 text-white/60 hover:text-white transition-colors",children:p||x===0?e.jsx(J,{size:18}):e.jsx(K,{size:18})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.01",value:p?0:x,onChange:$,className:"w-20 h-1 rounded-lg appearance-none cursor-pointer bg-white/20 accent-white"}),e.jsx("div",{className:"flex-1"}),e.jsx("button",{onClick:()=>P(!u),className:`p-2 rounded transition-colors ${u?"text-white bg-white/20":"text-white/40 hover:text-white/60"}`,title:u?"Loop: On":"Loop: Off",children:e.jsx(Q,{size:18})})]})]})]})]}),h&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("span",{className:"text-sm text-white/70 flex items-center gap-2",children:[h.type==="spotify"?"Spotify":h.type==="apple"?"Apple Music":"YouTube"," ","Player"]}),e.jsx("button",{onClick:()=>{c(""),v("")},className:"p-1 text-white/50 hover:text-white hover:bg-white/10 rounded transition-all",title:"Close player",children:e.jsx(k,{size:16})})]}),e.jsx("div",{className:`relative bg-black rounded-xl overflow-hidden shadow-lg border border-white/10 ${h.type==="youtube"?"pt-[56.25%]":"h-40"}`,children:e.jsx("iframe",{className:"absolute top-0 left-0 w-full h-full",src:h.src,title:"Media player",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share",allowFullScreen:!0,style:{border:0}})})]}),r.length>0&&e.jsxs("div",{className:"border-t border-white/10 pt-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-white/50 uppercase mb-3 flex items-center gap-2",children:[e.jsx(Z,{size:12})," Recent"]}),e.jsx("div",{className:"space-y-2",children:r.map((t,s)=>e.jsxs("div",{className:"w-full flex items-center gap-3 p-2 rounded-lg hover:bg-white/10 text-left group transition-colors",children:[e.jsxs("button",{onClick:()=>Y(t),className:"flex items-center gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-8 h-6 bg-white/10 rounded flex items-center justify-center shrink-0",children:t.includes("spotify")?e.jsx(w,{size:12,className:"text-green-400"}):t.includes("apple")?e.jsx(w,{size:12,className:"text-pink-500"}):e.jsx(b,{size:10,fill:"white",className:"ml-0.5"})}),e.jsx("span",{className:"text-xs text-white/70 truncate flex-1 group-hover:text-white",children:t})]}),e.jsx("button",{onClick:d=>{d.stopPropagation(),D(t)},className:"p-1 opacity-0 group-hover:opacity-100 text-white/50 hover:text-white hover:bg-white/10 rounded transition-all shrink-0",title:"Remove from history",children:e.jsx(k,{size:14})})]},s))})]}),e.jsxs("div",{className:"border-t border-white/10 pt-4",children:[e.jsxs("h4",{className:"text-xs font-bold text-white/50 uppercase mb-3 flex items-center gap-2",children:[e.jsx(ee,{size:12})," Recommended - No Copyright Music"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 overflow-y-auto pr-1",children:te.map(t=>e.jsxs("button",{onClick:()=>{const s=`https://www.youtube.com/watch?v=${t.videoId}`;c(s)},className:"group relative rounded-lg overflow-hidden bg-white/5 hover:bg-white/10 transition-all text-left",children:[e.jsxs("div",{className:"relative aspect-video",children:[e.jsx("img",{src:t.thumbnailUrl,alt:t.title,className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/60 to-transparent"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"w-8 h-8 bg-white/20 rounded-full flex items-center justify-center",children:e.jsx(b,{size:14,fill:"white",className:"ml-0.5"})})})]}),e.jsx("div",{className:"p-2",children:e.jsx("span",{className:"text-xs text-white/80 line-clamp-2 group-hover:text-white transition-colors",children:t.title})})]},t.id))})]})]})}const ae=a=>{if(!a)return null;const c=a.match(/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/);if(c&&c[2].length===11){const r=c[2];return{type:"youtube",src:`https://www.youtube.com/embed/${r}?enablejsapi=1&origin=${window.location.origin}&loop=1&playlist=${r}`}}if(a.includes("open.spotify.com")){let r=a;return a.includes("/embed")||(r=a.replace("open.spotify.com/","open.spotify.com/embed/")),{type:"spotify",src:r}}if(a.includes("music.apple.com")){let r=a;return a.includes("embed.music.apple.com")||(r=a.replace("music.apple.com","embed.music.apple.com")),{type:"apple",src:r}}return null};export{ne as default};
