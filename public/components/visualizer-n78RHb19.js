import{r as n,j as t,t as rt,u as J,v as ue,F as de,w as Fe,x as it,y as ot,z as at,X as ct,B as lt,D as ut,p as dt,i as ht,R as pt,T as xt,U as gt,S as mt}from"../vendor-CN66yN3J.js";import{p as ft,q as wt,P as bt,w as M,Q as he,i as pe,R as vt,S as jt,U as yt,V as zt,W as Ct,X as Nt,Y as Mt,j as St,Z as Pt}from"../index-CsuU2NyU.js";import{c as Rt,a as Dt,M as kt,D as Et,r as Tt}from"../visualizers/index-XPrSKJ0W.js";import"../visualizers/renderer-4zxM2zHw.js";import"../visualizers/utils-DsFqD6CR.js";const A=120,_=120,xe=400,ge=200;function At({onClose:U,isInPiP:Ye=!1,forceCenter:me=!1,stop:fe=!1}){const S=ft(),we=wt(),H=bt(),v=me||S==="center",be=n.useRef(null),Le=n.useRef(null),ve=n.useRef(0),[W,Xe]=M("zen_visualizer_mode",Et),[d,Y]=M("zen_visualizer_position",{x:50,y:50}),[i,K]=M("zen_visualizer_size",{width:xe,height:ge}),[P,je]=n.useState(!1);n.useEffect(()=>{Rt()},[i.width,i.height]);const[L,q]=M("zen_visualizer_logo",null),ee=n.useRef(null),[ye,$]=n.useState(!1),j=n.useRef(null),R=n.useRef(null),[u,D]=n.useState("none"),[ze,Ie]=n.useState(new Set),[Ce,Ne]=n.useState(""),[h,V]=M("zen_visualizer_config",Nt()),[k,Ae]=M("zen_visualizer_performance_mode",!1),[E,_e]=M("zen_visualizer_show_fps",!1),[te,Ue]=n.useState(!1),Me=n.useRef(k);n.useEffect(()=>{Me.current=k},[k]),n.useEffect(()=>{u!=="mode"&&Ne(""),u!=="none"&&Ie(e=>new Set(e).add(u))},[u]);const Se=n.useRef(0),se=n.useRef(0),Pe=n.useRef(performance.now()),Re=n.useRef(E);n.useEffect(()=>{Re.current=E},[E]),n.useEffect(()=>{if(L){const e=new Image;e.onload=()=>{ee.current=e},e.src=L}else ee.current=null},[L]),n.useEffect(()=>{he(h)},[]),n.useEffect(()=>()=>{Dt()},[]),n.useEffect(()=>()=>{j.current&&!j.current.closed&&j.current.close()},[]);const He=n.useCallback(e=>{var r;const s=(r=e.target.files)==null?void 0:r[0];if(s){const a=new FileReader;a.onload=c=>{var g;const x=(g=c.target)==null?void 0:g.result;q(x)},a.readAsDataURL(s)}},[q]),We=n.useCallback(()=>{q(null)},[q]),qe=n.useCallback(e=>{e.stopPropagation(),U==null||U()},[U]),[C,B]=n.useState(()=>pe()),[f,G]=n.useState(()=>vt()),ne=n.useRef(null),$e=n.useCallback(async()=>{const e=await jt();B(e),G(e?"tab":"none"),e&&D("none")},[]),Ve=n.useCallback(async()=>{const e=await yt();B(e),G(e?"mic":"none"),e&&D("none")},[]),Be=n.useCallback(async e=>{var r;const s=(r=e.target.files)==null?void 0:r[0];if(s){const a=await zt(s);B(a),G(a?"file":"none"),a&&D("none")}ne.current&&(ne.current.value="")},[]),Ge=n.useCallback(()=>{Pt(),B(!1),G("none")},[]),Oe=n.useCallback(e=>{e.stopPropagation(),D(s=>s==="audio"?"none":"audio")},[]),T=n.useCallback((e,s)=>{const r={...h,[e]:s};V(r),he({[e]:s})},[h,V]),Ze=n.useCallback(e=>{e.stopPropagation(),D(s=>s==="settings"?"none":"settings")},[]),Qe=n.useCallback(e=>{e.stopPropagation();const s=Ct();V(s),he(s)},[V]),Je=n.useCallback(async e=>{if(e.stopPropagation(),!window.documentPictureInPicture){alert("Document Picture-in-Picture is not supported in your browser. Please use Chrome 116+ or Edge 116+.");return}if(j.current&&!j.current.closed){j.current.close(),j.current=null,R.current=null,$(!1);return}try{const s=await window.documentPictureInPicture.requestWindow({width:i.width,height:i.height});j.current=s,s.document.body.style.margin="0",s.document.body.style.padding="0",s.document.body.style.overflow="hidden",s.document.body.style.background="linear-gradient(135deg, rgba(15, 15, 30, 1), rgba(30, 20, 50, 1))";const r=s.document.createElement("canvas");r.width=i.width,r.height=i.height,r.style.width="100%",r.style.height="100%",s.document.body.appendChild(r),R.current=r,s.addEventListener("pagehide",()=>{j.current=null,R.current=null,$(!1)}),$(!0)}catch(s){console.error("PiP error:",s),alert("Failed to activate Picture-in-Picture mode. Error: "+s.message),$(!1)}},[i]),[F,X]=n.useState(!1),[p,O]=n.useState(null),[Z,De]=n.useState(!1),Q=n.useRef({distance:0,width:xe,height:ge,centerX:0,centerY:0}),w=n.useRef({x:0,y:0,posX:0,posY:0}),o=n.useRef({x:0,y:0,width:xe,height:ge,posX:0,posY:0}),Ke=n.useCallback(e=>{e.target.classList.contains("resize-handle")||(e.preventDefault(),X(!0),w.current={x:e.clientX,y:e.clientY,posX:d.x,posY:d.y})},[d]),et=n.useCallback(e=>{if(!e.target.classList.contains("resize-handle")&&u==="none"){if(e.touches.length===1){const s=e.touches[0];X(!0),w.current={x:s.clientX,y:s.clientY,posX:d.x,posY:d.y}}else if(e.touches.length===2){e.preventDefault();const s=e.touches[0],r=e.touches[1],a=Math.hypot(r.clientX-s.clientX,r.clientY-s.clientY),c=(s.clientX+r.clientX)/2,x=(s.clientY+r.clientY)/2;De(!0),X(!1),Q.current={distance:a,width:i.width,height:i.height,centerX:c,centerY:x}}}},[d,i,u]),re=n.useCallback(e=>{if(F){const s=e.clientX-w.current.x,r=e.clientY-w.current.y;Y({x:w.current.posX+s,y:w.current.posY+r})}else if(p){const s=e.clientX-o.current.x,r=e.clientY-o.current.y;let a=o.current.width,c=o.current.height,x=o.current.posX,g=o.current.posY;if(p.includes("e")&&(a=Math.max(A,o.current.width+s)),p.includes("w")){const l=o.current.width-s;l>=A&&(a=l,x=o.current.posX+s)}if(p.includes("s")&&(c=Math.max(_,o.current.height+r)),p.includes("n")){const l=o.current.height-r;l>=_&&(c=l,g=o.current.posY+r)}K({width:a,height:c}),Y({x,y:g})}},[F,p,i.width,i.height]),ie=n.useCallback(e=>{if(F&&e.touches.length===1){const s=e.touches[0],r=s.clientX-w.current.x,a=s.clientY-w.current.y;Y({x:w.current.posX+r,y:w.current.posY+a})}else if(Z&&e.touches.length===2){e.preventDefault();const s=e.touches[0],r=e.touches[1],c=Math.hypot(r.clientX-s.clientX,r.clientY-s.clientY)/Q.current.distance,x=Math.max(A,Math.round(Q.current.width*c)),g=Math.max(_,Math.round(Q.current.height*c));K({width:x,height:g})}else if(p&&e.touches.length===1){const s=e.touches[0],r=s.clientX-o.current.x,a=s.clientY-o.current.y;let c=o.current.width,x=o.current.height,g=o.current.posX,l=o.current.posY;if(p.includes("e")&&(c=Math.max(A,o.current.width+r)),p.includes("w")){const b=o.current.width-r;b>=A&&(c=b,g=o.current.posX+r)}if(p.includes("s")&&(x=Math.max(_,o.current.height+a)),p.includes("n")){const b=o.current.height-a;b>=_&&(x=b,l=o.current.posY+a)}K({width:c,height:x}),Y({x:g,y:l})}},[F,Z,p]),oe=n.useCallback(()=>{X(!1),O(null)},[]),I=n.useCallback(()=>{X(!1),O(null),De(!1)},[]),y=n.useCallback((e,s)=>{e.preventDefault(),e.stopPropagation(),O(s),o.current={x:e.clientX,y:e.clientY,width:i.width,height:i.height,posX:d.x,posY:d.y}},[i,d]),z=n.useCallback((e,s)=>{if(e.preventDefault(),e.stopPropagation(),e.touches.length===1){const r=e.touches[0];O(s),o.current={x:r.clientX,y:r.clientY,width:i.width,height:i.height,posX:d.x,posY:d.y}}},[i,d]);n.useEffect(()=>{if(F||p||Z)return window.addEventListener("mousemove",re),window.addEventListener("mouseup",oe),window.addEventListener("touchmove",ie,{passive:!1}),window.addEventListener("touchend",I),window.addEventListener("touchcancel",I),()=>{window.removeEventListener("mousemove",re),window.removeEventListener("mouseup",oe),window.removeEventListener("touchmove",ie),window.removeEventListener("touchend",I),window.removeEventListener("touchcancel",I)}},[F,p,Z,re,oe,ie,I]);const ae=n.useRef(new Array(64).fill(0)),N=n.useRef(0);n.useEffect(()=>{const e=be.current;if(!e)return;const s=e.getContext("2d");if(!s)return;let r=!0;const a=async()=>{if(fe||!r)return;N.current+=.02;let c;if(pe())c=Mt();else{for(let m=0;m<ae.current.length;m++){const nt=.3+(Math.sin(N.current*2+m*.3)*.3+Math.sin(N.current*3.5+m*.5)*.2+Math.sin(N.current*1.2+m*.7)*.25)*.5;ae.current[m]=Math.max(0,Math.min(1,nt+Math.random()*.1))}c=ae.current}const x=c.length,g=pe()?St():{bass:Math.sin(N.current*1.25)*.3+.4,mid:Math.sin(N.current*1.3)*.25+.35,high:Math.sin(N.current*1.4)*.2+.3};let l=s,b=e;if(R.current){const m=R.current.getContext("2d");m&&(l=m,b=R.current)}if(l.clearRect(0,0,b.width,b.height),await Tt({ctx:l,canvas:b,data:c,barCount:x,performanceMode:Me.current,logoImage:ee.current,bass:g.bass,mid:g.mid,high:g.high,mode:W}),!!r){if(Re.current){l.save(),l.font="bold 12px monospace",l.fillStyle="rgba(255, 255, 255, 0.8)",l.shadowColor="rgba(0, 0, 0, 0.8)",l.shadowBlur=4,l.fillText(`${Se.current} FPS`,10,20),l.restore(),se.current++;const m=performance.now(),le=m-Pe.current;le>=500&&(Se.current=Math.round(se.current*1e3/le),se.current=0,Pe.current=m)}ve.current=requestAnimationFrame(a)}};return a(),()=>{r=!1,cancelAnimationFrame(ve.current)}},[W,fe]);const tt=()=>t.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 p-3 mx-2 rounded-lg",style:{background:"rgba(15, 15, 30, 0.7)",border:"1px solid rgba(168, 85, 247, 0.3)",maxHeight:i.height-50,overflowY:"auto"},onMouseDown:e=>e.stopPropagation(),children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("button",{onClick:()=>Ae(!k),className:`w-full px-3 py-2 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2 ${k?"text-green-400 bg-green-500/20 hover:bg-green-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Performance mode reduces visual effects for better framerate on low-end devices",children:[t.jsx(ut,{size:14}),"Performance Mode ",k?"ON":"OFF"]}),t.jsxs("button",{onClick:()=>_e(!E),className:`w-full px-3 py-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2 ${E?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Show FPS counter on the visualizer",children:["Show FPS ",E?"ON":"OFF"]}),t.jsxs("div",{className:"border-t border-white/10 pt-2",children:[t.jsxs("button",{onClick:()=>Ue(!te),className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer flex items-center justify-between",children:[t.jsxs("span",{className:"flex items-center gap-2",children:[t.jsx(Fe,{size:14}),"Audio Config"]}),te?t.jsx(dt,{size:14}):t.jsx(ht,{size:14})]}),te&&t.jsxs("div",{className:"mt-2 space-y-3 p-2 bg-white/5 rounded-md",children:[t.jsxs("button",{onClick:Qe,className:"w-full px-3 py-1.5 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",title:"Reset to defaults",children:[t.jsx(pt,{size:14}),"Reset to Defaults"]}),t.jsxs("div",{children:[t.jsx("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:t.jsx("span",{children:"FFT Size"})}),t.jsx("select",{value:h.fftSize,onChange:e=>T("fftSize",parseInt(e.target.value)),className:"w-full px-2 py-1 text-xs bg-white/10 text-white/90 rounded-md border border-white/20 cursor-pointer focus:outline-none focus:border-purple-500",children:[32,64,128,256,512,1024,2048,4096,8192,16384,32768].map(e=>t.jsx("option",{value:e,className:"bg-gray-900",children:e},e))})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Smoothing"}),t.jsx("span",{className:"text-purple-400",children:h.smoothingTimeConstant.toFixed(2)})]}),t.jsx("input",{type:"range",min:"0",max:"0.99",step:"0.01",value:h.smoothingTimeConstant,onChange:e=>T("smoothingTimeConstant",parseFloat(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Min dB"}),t.jsx("span",{className:"text-purple-400",children:h.minDecibels})]}),t.jsx("input",{type:"range",min:"-100",max:"-30",step:"1",value:h.minDecibels,onChange:e=>T("minDecibels",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Max dB"}),t.jsx("span",{className:"text-purple-400",children:h.maxDecibels})]}),t.jsx("input",{type:"range",min:"-50",max:"0",step:"1",value:h.maxDecibels,onChange:e=>T("maxDecibels",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Freq Start"}),t.jsx("span",{className:"text-purple-400",children:h.freqStartIndex})]}),t.jsx("input",{type:"range",min:"0",max:"1024",step:"1",value:h.freqStartIndex,onChange:e=>T("freqStartIndex",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Freq Count"}),t.jsx("span",{className:"text-purple-400",children:h.freqLength})]}),t.jsx("input",{type:"range",min:"5",max:"1024",step:"1",value:h.freqLength,onChange:e=>T("freqLength",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{className:"pt-2 border-t border-white/10",children:[t.jsx("label",{className:"flex justify-between text-xs text-white/70 mb-2",children:t.jsx("span",{children:"Center Logo (Trap Nation)"})}),L?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:L,alt:"Logo preview",className:"w-12 h-12 object-contain rounded bg-white/10"}),t.jsxs("button",{onClick:We,className:"flex-1 px-3 py-1.5 text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",children:[t.jsx(xt,{size:14}),"Remove"]})]}):t.jsxs("label",{className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",children:[t.jsx(gt,{size:14}),"Upload Image",t.jsx("input",{type:"file",accept:"image/*",onChange:He,className:"hidden"})]})]})]})]})]})}),ce=kt.filter(e=>e.toLowerCase().includes(Ce.toLowerCase())),ke=ce.filter(e=>!e.includes("(WebGL)")),Ee=ce.filter(e=>e.includes("(WebGL)")),Te=e=>t.jsx("button",{onClick:()=>{Xe(e)},className:`px-2 py-2 text-xs font-medium rounded-md transition-all cursor-pointer truncate ${W===e?"text-purple-400 bg-purple-500/30 border border-purple-500/50":"text-white/80 bg-white/10 hover:bg-white/20 border border-transparent"}`,title:e,children:e.replace(" (WebGL)","")},e),st=()=>t.jsxs("div",{className:"absolute top-10 left-0 right-0 z-20 p-3 mx-2 rounded-lg",style:{background:"rgba(15, 15, 30, 0.9)",border:"1px solid rgba(168, 85, 247, 0.3)",maxHeight:i.height-50,overflowY:"auto"},onMouseDown:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"relative mb-3",children:[t.jsx(mt,{size:14,className:"absolute left-2 top-1/2 -translate-y-1/2 text-white/50"}),t.jsx("input",{type:"text",placeholder:"Search modes...",value:Ce,onChange:e=>Ne(e.target.value),className:"w-full pl-7 pr-3 py-1.5 text-xs bg-white/10 text-white/90 rounded-md border border-white/20 focus:outline-none focus:border-purple-500 placeholder:text-white/40",autoFocus:!H})]}),ke.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2 mt-3 mb-2",children:[t.jsx("div",{className:"h-px flex-1 bg-white/20"}),t.jsx("span",{className:"text-xs text-white/50 font-medium",children:"Simple"}),t.jsx("div",{className:"h-px flex-1 bg-white/20"})]}),t.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:ke.map(Te)})]}),Ee.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2 mt-3 mb-2",children:[t.jsx("div",{className:"h-px flex-1 bg-white/20"}),t.jsx("span",{className:"text-xs text-white/50 font-medium",children:"WebGL"}),t.jsx("div",{className:"h-px flex-1 bg-white/20"})]}),t.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:Ee.map(Te)})]}),ce.length===0&&t.jsx("div",{className:"text-center text-white/50 text-xs py-4",children:"No modes found"})]});return t.jsx("div",{ref:Le,className:`select-none fixed ${v?"":"cursor-move"}`,style:v?{left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:i.width,height:i.height,zIndex:50}:{left:d.x,top:d.y,width:i.width,height:i.height,zIndex:40},onMouseDown:v?void 0:Ke,onTouchStart:v?void 0:et,onMouseEnter:()=>je(!0),onMouseLeave:()=>je(!1),children:t.jsxs("div",{className:`relative w-full h-full rounded-2xl overflow-hidden transition-all duration-300 ${v&&!P&&u==="none"?"":"backdrop-blur-md"}`,style:{background:v&&!P&&u==="none"?"transparent":"linear-gradient(135deg, rgba(15, 15, 30, 0.85), rgba(30, 20, 50, 0.85))",border:v&&!P&&u==="none"?"1px solid transparent":"1px solid rgba(168, 85, 247, 0.3)",boxShadow:v&&!P&&u==="none"?"none":"0 8px 32px rgba(0, 0, 0, 0.4), 0 0 60px rgba(168, 85, 247, 0.1)"},children:[t.jsxs("div",{className:`absolute top-0 left-0 right-0 flex items-center justify-between px-3 py-2 z-10 transition-opacity duration-300 ${v&&!P&&u==="none"?"opacity-0":""}`,style:{background:"linear-gradient(180deg, rgba(0,0,0,0.4), transparent)",opacity:P||u!=="none"?1:0},children:[t.jsx("span",{className:"text-xs font-medium text-white/60 uppercase tracking-wider"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs("button",{onClick:()=>{D(e=>e==="mode"?"none":"mode")},onMouseDown:e=>e.stopPropagation(),className:`px-2 py-1 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center gap-1.5 ${u==="mode"?"text-purple-400 bg-purple-500/20 hover:bg-purple-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Select visualizer mode",children:[t.jsx(rt,{size:12}),t.jsx("span",{className:"max-w-[80px] truncate",children:W})]}),t.jsxs("button",{onClick:Oe,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center gap-1 ${C?"text-green-400 bg-green-500/20 hover:bg-green-500/30":u==="audio"?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:C?`Audio: ${f}`:"Select audio source",children:[f==="mic"&&t.jsx(J,{size:14}),f==="tab"&&t.jsx(ue,{size:14}),f==="file"&&t.jsx(de,{size:14}),f==="none"&&t.jsx(J,{size:14})]}),t.jsx("button",{onClick:Ze,onMouseDown:e=>e.stopPropagation(),className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${u==="settings"?"text-blue-400 bg-blue-500/20 hover:bg-blue-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Audio analyzer settings",children:t.jsx(Fe,{size:14})}),!Ye&&!H&&t.jsx("button",{onClick:Je,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${ye?"text-purple-400 bg-purple-500/20 hover:bg-purple-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:ye?"Close PiP":"Open in PiP",children:t.jsx(it,{size:14})}),we&&!me&&t.jsx("button",{onClick:e=>{if(e.stopPropagation(),S==="center"){const s=(window.innerWidth-i.width)/2,r=(window.innerHeight-i.height)/2;Y({x:s,y:r})}we(S==="center"?"window":"center")},className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${S==="center"?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:S==="center"?"Switch to window mode":"Switch to center mode",children:S==="center"?t.jsx(ot,{size:14}):t.jsx(at,{size:14})}),t.jsx("button",{onClick:qe,className:"p-1.5 text-xs font-medium text-white/80 bg-white/10 hover:bg-red-500/30 hover:text-red-400 rounded-md transition-colors cursor-pointer",title:"Close visualizer",children:t.jsx(ct,{size:14})})]})]}),t.jsx("div",{className:u==="settings"?"":"hidden",children:ze.has("settings")&&tt()}),u==="audio"&&t.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 p-3 mx-2 rounded-lg",style:{background:"rgba(15, 15, 30, 0.9)",border:"1px solid rgba(168, 85, 247, 0.3)"},onMouseDown:e=>e.stopPropagation(),children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"text-xs text-white/60 font-medium mb-2",children:"Select Audio Source"}),C&&t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md bg-green-500/20 border border-green-500/30",children:[t.jsxs("span",{className:"text-xs text-green-400 flex items-center gap-2",children:[f==="mic"&&t.jsx(J,{size:14}),f==="tab"&&t.jsx(ue,{size:14}),f==="file"&&t.jsx(de,{size:14}),f==="tab"&&"Tab Audio",f==="mic"&&"Microphone",f==="file"&&"Audio File"]}),t.jsxs("button",{onClick:Ge,className:"px-2 py-1 text-xs text-red-400 bg-red-500/20 hover:bg-red-500/30 rounded-md transition-colors flex items-center gap-1",children:[t.jsx(lt,{size:12}),"Stop"]})]}),!H&&!C&&t.jsxs("button",{onClick:$e,className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors flex items-center gap-2",children:[t.jsx(ue,{size:14}),"Capture Tab Audio"]}),!C&&t.jsxs("button",{onClick:Ve,className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors flex items-center gap-2",children:[t.jsx(J,{size:14}),"Use Microphone"]}),!C&&t.jsxs("label",{className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors flex items-center gap-2 cursor-pointer",children:[t.jsx(de,{size:14}),"Upload Audio/Video File",t.jsx("input",{ref:ne,type:"file",accept:"audio/*,video/*",onChange:Be,className:"hidden"})]}),!C&&t.jsx("p",{className:"text-xs text-white/40 mt-2",children:H?"Tab audio capture is not available on mobile devices.":"Choose how you want to provide audio for the visualizer."})]})}),t.jsx("div",{className:u==="mode"?"":"hidden",children:ze.has("mode")&&st()}),t.jsx("canvas",{ref:be,width:i.width,height:i.height,className:"w-full h-full"}),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"resize-handle absolute top-0 left-0 w-4 h-4 cursor-nw-resize",onMouseDown:e=>y(e,"nw"),onTouchStart:e=>z(e,"nw")}),t.jsx("div",{className:"resize-handle absolute top-0 right-0 w-4 h-4 cursor-ne-resize",onMouseDown:e=>y(e,"ne"),onTouchStart:e=>z(e,"ne")}),t.jsx("div",{className:"resize-handle absolute bottom-0 left-0 w-4 h-4 cursor-sw-resize",onMouseDown:e=>y(e,"sw"),onTouchStart:e=>z(e,"sw")}),t.jsx("div",{className:"resize-handle absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",onMouseDown:e=>y(e,"se"),onTouchStart:e=>z(e,"se")}),t.jsx("div",{className:"resize-handle absolute top-0 left-4 right-4 h-2 cursor-n-resize",onMouseDown:e=>y(e,"n"),onTouchStart:e=>z(e,"n")}),t.jsx("div",{className:"resize-handle absolute bottom-0 left-4 right-4 h-2 cursor-s-resize",onMouseDown:e=>y(e,"s"),onTouchStart:e=>z(e,"s")}),t.jsx("div",{className:"resize-handle absolute left-0 top-4 bottom-4 w-2 cursor-w-resize",onMouseDown:e=>y(e,"w"),onTouchStart:e=>z(e,"w")}),t.jsx("div",{className:"resize-handle absolute right-0 top-4 bottom-4 w-2 cursor-e-resize",onMouseDown:e=>y(e,"e"),onTouchStart:e=>z(e,"e")})]})]})})}export{At as default};
