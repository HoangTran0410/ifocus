const w={time:0};function R({ctx:e,canvas:l,data:z,performanceMode:f=!1,bass:g=0}){const p=l.width/2,c=l.height/2,S=Math.min(l.height*.3,l.width*.2),P=l.width*.85,m=(l.width-P)/2,$=z.reduce((t,i)=>t+i,0)/z.length;w.time+=.03+$*.02+g*.05;const M=f?50:80,I=1.5,r=[];for(let t=0;t<=M;t++){const i=t/M,o=m+i*P,n=Math.floor(i*z.length),s=z[n]||$,a=i*Math.PI*2*I+w.time,h=S*(.7+s*.4),d=Math.cos(a),y=c+Math.sin(a)*h,C=4+s*5+g*3;r.push({x:o,y,z:d,size:C*(.5+(d+1)*.35),intensity:s,strand:0});const u=Math.cos(a+Math.PI),G=c+Math.sin(a+Math.PI)*h,b=4+s*5+g*3;r.push({x:o,y:G,z:u,size:b*(.5+(u+1)*.35),intensity:s,strand:1})}r.sort((t,i)=>t.z-i.z);for(const t of r){const i=(t.z+1)/2,o=t.strand===0?270:320,n=80+i*20,s=35+i*30+t.intensity*15,a=.4+i*.5+t.intensity*.1;if(!f&&t.size>3&&i>.3){const d=t.size*2.5,y=e.createRadialGradient(t.x,t.y,0,t.x,t.y,d);y.addColorStop(0,`hsla(${o}, 100%, 70%, ${i*.25})`),y.addColorStop(1,"transparent"),e.beginPath(),e.arc(t.x,t.y,d,0,Math.PI*2),e.fillStyle=y,e.fill()}const h=e.createRadialGradient(t.x-t.size*.3,t.y-t.size*.3,0,t.x,t.y,t.size);h.addColorStop(0,`hsla(${o}, ${n}%, ${Math.min(90,s+25)}%, ${a})`),h.addColorStop(.5,`hsla(${o}, ${n}%, ${s}%, ${a})`),h.addColorStop(1,`hsla(${o}, ${n}%, ${Math.max(20,s-20)}%, ${a})`),e.beginPath(),e.arc(t.x,t.y,t.size,0,Math.PI*2),e.fillStyle=h,e.fill(),i>.4&&t.size>2&&(e.beginPath(),e.arc(t.x-t.size*.25,t.y-t.size*.25,t.size*.3,0,Math.PI*2),e.fillStyle=`rgba(255, 255, 255, ${.3+i*.4})`,e.fill())}if(!f)for(let t=0;t<2;t++){const i=r.filter(n=>n.strand===t).sort((n,s)=>n.x-s.x);e.beginPath();for(let n=0;n<i.length;n++){const s=i[n];(s.z+1)/2,n===0?e.moveTo(s.x,s.y):e.lineTo(s.x,s.y)}const o=t===0?270:320;e.strokeStyle=`hsla(${o}, 80%, 55%, 0.3)`,e.lineWidth=2,e.stroke()}if(!f){const t=e.createRadialGradient(p,c,0,p,c,S*1.5);t.addColorStop(0,`rgba(168, 85, 247, ${$*.1})`),t.addColorStop(1,"transparent"),e.fillStyle=t,e.fillRect(0,0,l.width,l.height)}}export{R as default};
