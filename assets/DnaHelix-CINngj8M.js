const w={time:0};function R({ctx:s,canvas:l,data:y,performanceMode:f=!1,beatIntensity:g=0}){const p=l.width/2,c=l.height/2,S=Math.min(l.height*.3,l.width*.2),P=l.width*.85,m=(l.width-P)/2,$=y.reduce((t,i)=>t+i,0)/y.length;w.time+=.03+$*.02+g*.04;const M=f?50:80,C=1.5,r=[];for(let t=0;t<=M;t++){const i=t/M,n=m+i*P,o=Math.floor(i*y.length),e=y[o]||$,a=i*Math.PI*2*C+w.time,h=S*(.7+e*.4),d=Math.cos(a),z=c+Math.sin(a)*h,I=4+e*5+g*3;r.push({x:n,y:z,z:d,size:I*(.5+(d+1)*.35),intensity:e,strand:0});const u=Math.cos(a+Math.PI),G=c+Math.sin(a+Math.PI)*h,b=4+e*5+g*3;r.push({x:n,y:G,z:u,size:b*(.5+(u+1)*.35),intensity:e,strand:1})}r.sort((t,i)=>t.z-i.z);for(const t of r){const i=(t.z+1)/2,n=t.strand===0?270:320,o=80+i*20,e=35+i*30+t.intensity*15,a=.4+i*.5+t.intensity*.1;if(!f&&t.size>3&&i>.3){const d=t.size*2.5,z=s.createRadialGradient(t.x,t.y,0,t.x,t.y,d);z.addColorStop(0,`hsla(${n}, 100%, 70%, ${i*.25})`),z.addColorStop(1,"transparent"),s.beginPath(),s.arc(t.x,t.y,d,0,Math.PI*2),s.fillStyle=z,s.fill()}const h=s.createRadialGradient(t.x-t.size*.3,t.y-t.size*.3,0,t.x,t.y,t.size);h.addColorStop(0,`hsla(${n}, ${o}%, ${Math.min(90,e+25)}%, ${a})`),h.addColorStop(.5,`hsla(${n}, ${o}%, ${e}%, ${a})`),h.addColorStop(1,`hsla(${n}, ${o}%, ${Math.max(20,e-20)}%, ${a})`),s.beginPath(),s.arc(t.x,t.y,t.size,0,Math.PI*2),s.fillStyle=h,s.fill(),i>.4&&t.size>2&&(s.beginPath(),s.arc(t.x-t.size*.25,t.y-t.size*.25,t.size*.3,0,Math.PI*2),s.fillStyle=`rgba(255, 255, 255, ${.3+i*.4})`,s.fill())}if(!f)for(let t=0;t<2;t++){const i=r.filter(o=>o.strand===t).sort((o,e)=>o.x-e.x);s.beginPath();for(let o=0;o<i.length;o++){const e=i[o];(e.z+1)/2,o===0?s.moveTo(e.x,e.y):s.lineTo(e.x,e.y)}const n=t===0?270:320;s.strokeStyle=`hsla(${n}, 80%, 55%, 0.3)`,s.lineWidth=2,s.stroke()}if(!f){const t=s.createRadialGradient(p,c,0,p,c,S*1.5);t.addColorStop(0,`rgba(168, 85, 247, ${$*.1})`),t.addColorStop(1,"transparent"),s.fillStyle=t,s.fillRect(0,0,l.width,l.height)}}export{R as default};
