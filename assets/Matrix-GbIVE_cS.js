const o={drops:[],lastColumns:0,initialized:!1},y="ｦｧｨｩｪｫｬｭｮｯｰｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝ0123456789";function u(){return y[Math.floor(Math.random()*y.length)]}function C(){const e=Math.floor(Math.random()*15)+5;return{yRatio:Math.random(),speed:Math.random()*2+1,length:e,chars:Array.from({length:e},()=>u())}}function G({ctx:e,canvas:l,data:a,performanceMode:r=!1,beatIntensity:S=0,bass:w=0}){const f=a.reduce((t,h)=>t+h,0)/a.length,i=r?16:14,R=1+w*1.2,d=Math.round(i*R),n=Math.floor(l.width/i);if(o.initialized){if(n!==o.lastColumns){if(n>o.lastColumns)for(let t=o.lastColumns;t<n;t++)o.drops.push(C());else o.drops=o.drops.slice(0,n);o.lastColumns=n}}else{o.drops=[];for(let t=0;t<n;t++)o.drops.push(C());o.lastColumns=n,o.initialized=!0}e.font=`${d}px monospace`;const b=.005+S*.003;if(o.drops.forEach((t,h)=>{const p=Math.floor(h/n*a.length),c=a[p]||f,z=h*i,$=1+c;t.yRatio+=t.speed*b*$;const A=t.length*i,m=l.height+A,B=t.yRatio*m,I=(d-i)/2;for(let s=0;s<t.length;s++){const g=B-s*i;if(g<0||g>l.height+i)continue;const M=1-s/t.length;if(s===0)e.fillStyle=`rgba(180, 255, 180, ${M})`,r||(e.shadowColor="#0f0",e.shadowBlur=10);else{const F=Math.floor(200+c*55);e.fillStyle=`rgba(0, ${F}, 70, ${M*.8})`,e.shadowBlur=0}Math.random()<.02&&(t.chars[s]=u()),e.fillText(t.chars[s],z-I,g)}e.shadowBlur=0,t.yRatio>1&&(t.yRatio=-t.length*d/m,t.speed=Math.random()*2+1,t.length=Math.floor(Math.random()*15)+5,t.chars=Array.from({length:t.length},()=>u()))}),!r&&f>.1){const t=e.createRadialGradient(l.width/2,l.height/2,0,l.width/2,l.height/2,l.width/2);t.addColorStop(0,`rgba(0, 255, 70, ${f*.5})`),t.addColorStop(1,"rgba(0, 255, 70, 0)"),e.fillStyle=t,e.fillRect(0,0,l.width,l.height)}}export{G as default};
