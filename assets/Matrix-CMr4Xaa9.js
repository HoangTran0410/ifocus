const e={drops:[],lastColumns:0,initialized:!1},C="ｦｧｨｩｪｫｬｭｮｯｰｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝ0123456789";function u(){return C[Math.floor(Math.random()*C.length)]}function S(){const o=Math.floor(Math.random()*15)+5;return{yRatio:Math.random(),speed:Math.random()*2+1,length:o,chars:Array.from({length:o},()=>u())}}function G({ctx:o,canvas:l,data:h,performanceMode:r=!1,beatIntensity:c=0}){const f=h.reduce((t,a)=>t+a,0)/h.length,i=r?16:14,w=1+c*1,d=Math.round(i*w),n=Math.floor(l.width/i);if(e.initialized){if(n!==e.lastColumns){if(n>e.lastColumns)for(let t=e.lastColumns;t<n;t++)e.drops.push(S());else e.drops=e.drops.slice(0,n);e.lastColumns=n}}else{e.drops=[];for(let t=0;t<n;t++)e.drops.push(S());e.lastColumns=n,e.initialized=!0}o.font=`${d}px monospace`;const R=.005+c*.003;if(e.drops.forEach((t,a)=>{const p=Math.floor(a/n*h.length),m=h[p]||f,b=a*i,z=1+m;t.yRatio+=t.speed*R*z;const $=t.length*i,M=l.height+$,A=t.yRatio*M,B=(d-i)/2;for(let s=0;s<t.length;s++){const g=A-s*i;if(g<0||g>l.height+i)continue;const y=1-s/t.length;if(s===0)o.fillStyle=`rgba(180, 255, 180, ${y})`,r||(o.shadowColor="#0f0",o.shadowBlur=10);else{const F=Math.floor(200+m*55);o.fillStyle=`rgba(0, ${F}, 70, ${y*.8})`,o.shadowBlur=0}Math.random()<.02&&(t.chars[s]=u()),o.fillText(t.chars[s],b-B,g)}o.shadowBlur=0,t.yRatio>1&&(t.yRatio=-t.length*d/M,t.speed=Math.random()*2+1,t.length=Math.floor(Math.random()*15)+5,t.chars=Array.from({length:t.length},()=>u()))}),!r&&f>.1){const t=o.createRadialGradient(l.width/2,l.height/2,0,l.width/2,l.height/2,l.width/2);t.addColorStop(0,`rgba(0, 255, 70, ${f*.5})`),t.addColorStop(1,"rgba(0, 255, 70, 0)"),o.fillStyle=t,o.fillRect(0,0,l.width,l.height)}}export{G as default};
