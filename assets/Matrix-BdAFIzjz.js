const o={drops:[],lastColumns:0,initialized:!1},M="ｦｧｨｩｪｫｬｭｮｯｰｱｲｳｴｵｶｷｸｹｺｻｼｽｾｿﾀﾁﾂﾃﾄﾅﾆﾇﾈﾉﾊﾋﾌﾍﾎﾏﾐﾑﾒﾓﾔﾕﾖﾗﾘﾙﾚﾛﾜﾝ0123456789";function g(){return M[Math.floor(Math.random()*M.length)]}function y(){const e=Math.floor(Math.random()*15)+5;return{yRatio:Math.random(),speed:Math.random()*2+1,length:e,chars:Array.from({length:e},()=>g())}}function A({ctx:e,canvas:l,data:s,performanceMode:r=!1,beatIntensity:C=0}){const f=s.reduce((t,a)=>t+a,0)/s.length,n=r?16:14,i=Math.floor(l.width/n);if(o.initialized){if(i!==o.lastColumns){if(i>o.lastColumns)for(let t=o.lastColumns;t<i;t++)o.drops.push(y());else o.drops=o.drops.slice(0,i);o.lastColumns=i}}else{o.drops=[];for(let t=0;t<i;t++)o.drops.push(y());o.lastColumns=i,o.initialized=!0}e.font=`${n}px monospace`;const w=.005+C*.005;if(o.drops.forEach((t,a)=>{const R=Math.floor(a/i*s.length),u=s[R]||f,S=a*n,p=1+u;t.yRatio+=t.speed*w*p;const b=t.length*n,m=l.height+b,$=t.yRatio*m;for(let h=0;h<t.length;h++){const d=$-h*n;if(d<0||d>l.height+n)continue;const c=1-h/t.length;if(h===0)e.fillStyle=`rgba(180, 255, 180, ${c})`,r||(e.shadowColor="#0f0",e.shadowBlur=10);else{const z=Math.floor(200+u*55);e.fillStyle=`rgba(0, ${z}, 70, ${c*.8})`,e.shadowBlur=0}Math.random()<.02&&(t.chars[h]=g()),e.fillText(t.chars[h],S,d)}e.shadowBlur=0,t.yRatio>1&&(t.yRatio=-t.length*n/m,t.speed=Math.random()*2+1,t.length=Math.floor(Math.random()*15)+5,t.chars=Array.from({length:t.length},()=>g()))}),!r&&f>.3){const t=e.createRadialGradient(l.width/2,l.height/2,0,l.width/2,l.height/2,l.width/2);t.addColorStop(0,`rgba(0, 255, 70, ${f*.15})`),t.addColorStop(1,"rgba(0, 255, 70, 0)"),e.fillStyle=t,e.fillRect(0,0,l.width,l.height)}}export{A as default};
