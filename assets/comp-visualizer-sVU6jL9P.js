const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Bars-D7fNdVeo.js","./vendor-woyHwGIK.js","./comp-audiocontroller-B2mKwfGK.js","./comp-background-BQc3B6eU.js","./Wave-DFOD-lfe.js","./Circular-DhbHqw5-.js","./Spectrum-DqG2f6-o.js","./RadialLines-1m40R7j0.js"])))=>i.map(i=>d[i]);
import{r as s,j as t,s as Re,t as Ne,u as De,v as Me,w as Ie,X as Le,T as Se,U as Ae,x as Te,R as ke}from"./vendor-woyHwGIK.js";import{u as R}from"./comp-audiocontroller-B2mKwfGK.js";import{_ as a,f as Oe,g as Ve,z as W,A as $,B as Fe,C as He,D as Xe,E as Ye,F as Ue,G as qe}from"./comp-background-BQc3B6eU.js";const B={"ðŸ“Š Bars":()=>a(()=>import("./Bars-D7fNdVeo.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),"ðŸŒŠ Wave":()=>a(()=>import("./Wave-DFOD-lfe.js"),__vite__mapDeps([4,1,2,3]),import.meta.url),"ðŸŸ£ Circular":()=>a(()=>import("./Circular-DhbHqw5-.js"),__vite__mapDeps([5,1,2,3]),import.meta.url),"ðŸ”Š TrapNation":()=>a(()=>import("./TrapNation-DhJT4_Je.js"),[],import.meta.url),"ðŸŒˆ Spectrum":()=>a(()=>import("./Spectrum-DqG2f6-o.js"),__vite__mapDeps([6,1,2,3]),import.meta.url),"âœ¨ Particles":()=>a(()=>import("./Particles-BPfqwlbt.js"),[],import.meta.url),"ðŸ§¬ DnaHelix":()=>a(()=>import("./DnaHelix-GrQ9V3EB.js"),[],import.meta.url),"ã€°ï¸ Oscilloscope":()=>a(()=>import("./Oscilloscope-D17QgPTu.js"),[],import.meta.url),"ðŸ”† RadialLines":()=>a(()=>import("./RadialLines-1m40R7j0.js"),__vite__mapDeps([7,1,2,3]),import.meta.url),"ðŸŒŒ Galaxy":()=>a(()=>import("./Galaxy-BYCvO4Qi.js"),[],import.meta.url),"âš« BlackHole":()=>a(()=>import("./BlackHole-BbqcLKfF.js"),[],import.meta.url),"ðŸ’» Matrix":()=>a(()=>import("./Matrix-BdAFIzjz.js"),[],import.meta.url),"ðŸŽ† Fireworks":()=>a(()=>import("./Fireworks-CNrap32i.js"),[],import.meta.url),"ðŸŒ  Aurora":()=>a(()=>import("./Aurora-Dk7W9Cd1.js"),[],import.meta.url),"ðŸ’ Rings":()=>a(()=>import("./Rings-DgMegcz4.js"),[],import.meta.url),"ðŸ“ˆ Waveform3D":()=>a(()=>import("./Waveform3D-Dvi4KWOi.js"),[],import.meta.url),"â­ Starfield":()=>a(()=>import("./Starfield-Cn86jYBA.js"),[],import.meta.url)},de=Object.keys(B),he=de[0],ie=new Map;async function oe(d,y){let h=ie.get(d);if(!h){const p=await(B[d]||B[he])();if(!p.default)throw new Error(`Invalid render function for mode: ${d}`);h=p.default,ie.set(d,h)}h(y)}const V=new Map,We=()=>{V.clear()},Je=(d,y,h)=>(V.has(y)||V.set(y,h()),V.get(y)),ae=120,le=120,ce=400,ue=200;function $e({onClose:d,isInPiP:y=!1,forceCenter:h=!1,stop:F=!1}){const p=Oe(),G=Ve(),m=h||p==="center",Z=s.useRef(null),pe=s.useRef(null),J=s.useRef(0),[I,K]=R("zen_visualizer_mode",he),[f,H]=R("zen_visualizer_position",{x:50,y:50}),[i,me]=R("zen_visualizer_size",{width:ce,height:ue}),[z,Q]=s.useState(!1);s.useEffect(()=>{We()},[i.width,i.height]);const[N,L]=R("zen_visualizer_logo",null),S=s.useRef(null),[ee,A]=s.useState(!1),x=s.useRef(null),w=s.useRef(null),[g,xe]=s.useState(!1),[l,T]=R("zen_visualizer_config",Xe()),[E,ge]=R("zen_visualizer_performance_mode",!1),X=s.useRef(E);s.useEffect(()=>{X.current=E},[E]),s.useEffect(()=>{if(N){const e=new Image;e.onload=()=>{S.current=e},e.src=N}else S.current=null},[N]),s.useEffect(()=>{W(l)},[]),s.useEffect(()=>()=>{x.current&&!x.current.closed&&x.current.close()},[]);const fe=s.useCallback(e=>{var n;const r=(n=e.target.files)==null?void 0:n[0];if(r){const u=new FileReader;u.onload=_=>{var j;const C=(j=_.target)==null?void 0:j.result;L(C)},u.readAsDataURL(r)}},[L]),we=s.useCallback(()=>{L(null)},[L]),be=s.useCallback(e=>{e.stopPropagation(),K(e.target.value)},[K]),ve=s.useCallback(e=>{e.stopPropagation(),d==null||d()},[d]),[k,te]=s.useState(()=>$()),_e=s.useCallback(async e=>{if(e.stopPropagation(),k)qe(),te(!1);else{const r=await Fe();te(r)}},[k]),P=s.useCallback((e,r)=>{const n={...l,[e]:r};T(n),W({[e]:r})},[l,T]),je=s.useCallback(e=>{e.stopPropagation(),xe(r=>!r)},[]),ye=s.useCallback(e=>{e.stopPropagation();const r=He();T(r),W(r)},[T]),ze=s.useCallback(async e=>{if(e.stopPropagation(),!window.documentPictureInPicture){alert("Document Picture-in-Picture is not supported in your browser. Please use Chrome 116+ or Edge 116+.");return}if(x.current&&!x.current.closed){x.current.close(),x.current=null,w.current=null,A(!1);return}try{const r=await window.documentPictureInPicture.requestWindow({width:i.width,height:i.height});x.current=r,r.document.body.style.margin="0",r.document.body.style.padding="0",r.document.body.style.overflow="hidden",r.document.body.style.background="linear-gradient(135deg, rgba(15, 15, 30, 1), rgba(30, 20, 50, 1))";const n=r.document.createElement("canvas");n.width=i.width,n.height=i.height,n.style.width="100%",n.style.height="100%",r.document.body.appendChild(n),w.current=n,r.addEventListener("pagehide",()=>{x.current=null,w.current=null,A(!1)}),A(!0)}catch(r){console.error("PiP error:",r),alert("Failed to activate Picture-in-Picture mode. Error: "+r.message),A(!1)}},[i]),[O,re]=s.useState(!1),[b,se]=s.useState(null),D=s.useRef({x:0,y:0,posX:0,posY:0}),c=s.useRef({x:0,y:0,width:ce,height:ue,posX:0,posY:0}),Ce=s.useCallback(e=>{e.target.classList.contains("resize-handle")||(e.preventDefault(),re(!0),D.current={x:e.clientX,y:e.clientY,posX:f.x,posY:f.y})},[f]),Y=s.useCallback(e=>{if(O){const r=e.clientX-D.current.x,n=e.clientY-D.current.y;H({x:D.current.posX+r,y:D.current.posY+n})}else if(b){const r=e.clientX-c.current.x,n=e.clientY-c.current.y;let u=c.current.width,_=c.current.height,C=c.current.posX,j=c.current.posY;if(b.includes("e")&&(u=Math.max(ae,c.current.width+r)),b.includes("w")){const o=c.current.width-r;o>=ae&&(u=o,C=c.current.posX+r)}if(b.includes("s")&&(_=Math.max(le,c.current.height+n)),b.includes("n")){const o=c.current.height-n;o>=le&&(_=o,j=c.current.posY+n)}me({width:u,height:_}),H({x:C,y:j})}},[O,b,i.width,i.height]),U=s.useCallback(()=>{re(!1),se(null)},[]),v=s.useCallback((e,r)=>{e.preventDefault(),e.stopPropagation(),se(r),c.current={x:e.clientX,y:e.clientY,width:i.width,height:i.height,posX:f.x,posY:f.y}},[i,f]);s.useEffect(()=>{if(O||b)return window.addEventListener("mousemove",Y),window.addEventListener("mouseup",U),()=>{window.removeEventListener("mousemove",Y),window.removeEventListener("mouseup",U)}},[O,b,Y,U]);const q=s.useRef(new Array(64).fill(0)),M=s.useRef(0);s.useEffect(()=>{const e=Z.current;if(!e)return;const r=e.getContext("2d");if(!r)return;const n=async()=>{if(F)return;M.current+=.02;let u;if($())u=Ye();else{for(let o=0;o<q.current.length;o++){const Pe=.3+(Math.sin(M.current*2+o*.3)*.3+Math.sin(M.current*3.5+o*.5)*.2+Math.sin(M.current*1.2+o*.7)*.25)*.5;q.current[o]=Math.max(0,Math.min(1,Pe+Math.random()*.1))}u=q.current}const _=u.length,C=$()?Ue():Math.sin(M.current*4)*.3+.3;let j=!1;if(w.current){const o=w.current.getContext("2d");if(o){o.clearRect(0,0,w.current.width,w.current.height);const ne={ctx:o,canvas:w.current,data:u,barCount:_,performanceMode:X.current,logoImage:S.current,beatIntensity:C};await oe(I,ne),j=!0}}if(!j){r.clearRect(0,0,e.width,e.height);const o={ctx:r,canvas:e,data:u,barCount:_,performanceMode:X.current,logoImage:S.current,beatIntensity:C};await oe(I,o)}J.current=requestAnimationFrame(n)};return n(),()=>{cancelAnimationFrame(J.current)}},[I,F]);const Ee=()=>t.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 p-3 mx-2 rounded-lg",style:{background:"rgba(15, 15, 30, 0.45)",border:"1px solid rgba(168, 85, 247, 0.3)",maxHeight:i.height-50,overflowY:"auto"},onMouseDown:e=>e.stopPropagation(),children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:t.jsx("span",{children:"FFT Size"})}),t.jsx("select",{value:l.fftSize,onChange:e=>P("fftSize",parseInt(e.target.value)),className:"w-full px-2 py-1 text-xs bg-white/10 text-white/90 rounded-md border border-white/20 cursor-pointer focus:outline-none focus:border-purple-500",children:[32,64,128,256,512,1024,2048,4096,8192,16384,32768].map(e=>t.jsx("option",{value:e,className:"bg-gray-900",children:e},e))})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Smoothing"}),t.jsx("span",{className:"text-purple-400",children:l.smoothingTimeConstant.toFixed(2)})]}),t.jsx("input",{type:"range",min:"0",max:"0.99",step:"0.01",value:l.smoothingTimeConstant,onChange:e=>P("smoothingTimeConstant",parseFloat(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Min dB"}),t.jsx("span",{className:"text-purple-400",children:l.minDecibels})]}),t.jsx("input",{type:"range",min:"-100",max:"-30",step:"1",value:l.minDecibels,onChange:e=>P("minDecibels",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Max dB"}),t.jsx("span",{className:"text-purple-400",children:l.maxDecibels})]}),t.jsx("input",{type:"range",min:"-50",max:"0",step:"1",value:l.maxDecibels,onChange:e=>P("maxDecibels",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Freq Start"}),t.jsx("span",{className:"text-purple-400",children:l.freqStartIndex})]}),t.jsx("input",{type:"range",min:"0",max:"1024",step:"1",value:l.freqStartIndex,onChange:e=>P("freqStartIndex",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Freq Count"}),t.jsx("span",{className:"text-purple-400",children:l.freqLength})]}),t.jsx("input",{type:"range",min:"5",max:"1024",step:"1",value:l.freqLength,onChange:e=>P("freqLength",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{className:"pt-2 border-t border-white/10",children:[t.jsx("label",{className:"flex justify-between text-xs text-white/70 mb-2",children:t.jsx("span",{children:"Center Logo (Trap Nation)"})}),N?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:N,alt:"Logo preview",className:"w-12 h-12 object-contain rounded bg-white/10"}),t.jsxs("button",{onClick:we,className:"flex-1 px-3 py-1.5 text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",children:[t.jsx(Se,{size:14}),"Remove"]})]}):t.jsxs("label",{className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",children:[t.jsx(Ae,{size:14}),"Upload Image",t.jsx("input",{type:"file",accept:"image/*",onChange:fe,className:"hidden"})]})]}),t.jsxs("div",{className:"pt-2 border-t border-white/10",children:[t.jsxs("button",{onClick:()=>ge(!E),className:`w-full px-3 py-2 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2 ${E?"text-green-400 bg-green-500/20 hover:bg-green-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Performance mode reduces visual effects for better framerate on low-end devices",children:[t.jsx(Te,{size:14}),"Performance Mode ",E?"ON":"OFF"]}),t.jsx("p",{className:"text-[10px] text-white/40 mt-1 text-center",children:"Reduces effects for better FPS"})]}),t.jsxs("button",{onClick:ye,className:"w-full mt-2 px-3 py-1.5 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",title:"Reset to defaults",children:[t.jsx(ke,{size:14}),"Reset to Defaults"]})]})});return t.jsx("div",{ref:pe,className:`select-none fixed ${m?"":"cursor-move"}`,style:m?{left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:i.width,height:i.height,zIndex:50}:{left:f.x,top:f.y,width:i.width,height:i.height,zIndex:40},onMouseDown:m?void 0:Ce,onMouseEnter:()=>Q(!0),onMouseLeave:()=>Q(!1),children:t.jsxs("div",{className:`relative w-full h-full rounded-2xl overflow-hidden transition-all duration-300 ${m&&!z&&!g?"":"backdrop-blur-md"}`,style:{background:m&&!z&&!g?"transparent":"linear-gradient(135deg, rgba(15, 15, 30, 0.85), rgba(30, 20, 50, 0.85))",border:m&&!z&&!g?"1px solid transparent":"1px solid rgba(168, 85, 247, 0.3)",boxShadow:m&&!z&&!g?"none":"0 8px 32px rgba(0, 0, 0, 0.4), 0 0 60px rgba(168, 85, 247, 0.1)"},children:[t.jsxs("div",{className:`absolute top-0 left-0 right-0 flex items-center justify-between px-3 py-2 z-10 transition-opacity duration-300 ${m&&!z&&!g?"opacity-0":""}`,style:{background:"linear-gradient(180deg, rgba(0,0,0,0.4), transparent)",opacity:m?z||g?1:0:g||z?1:.4},children:[t.jsx("span",{className:"text-xs font-medium text-white/60 uppercase tracking-wider",children:"Visualizer"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:_e,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${k?"text-green-400 bg-green-500/20 hover:bg-green-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:k?"Stop audio capture":"Capture tab audio",children:t.jsx(Re,{size:14})}),!y&&t.jsx("button",{onClick:ze,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${ee?"text-purple-400 bg-purple-500/20 hover:bg-purple-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:ee?"Close PiP":"Open in PiP",children:t.jsx(Ne,{size:14})}),t.jsx("button",{onClick:je,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${g?"text-amber-400 bg-amber-500/20 hover:bg-amber-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Audio analyzer settings",children:t.jsx(De,{size:14})}),t.jsx("select",{value:I,onChange:be,onMouseDown:e=>e.stopPropagation(),className:"px-2 py-1 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer border-none focus:outline-none",children:de.map(e=>t.jsx("option",{value:e,className:"bg-gray-900 text-white",children:e},e))}),G&&!h&&t.jsx("button",{onClick:e=>{if(e.stopPropagation(),p==="center"){const r=(window.innerWidth-i.width)/2,n=(window.innerHeight-i.height)/2;H({x:r,y:n})}G(p==="center"?"window":"center")},className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${p==="center"?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:p==="center"?"Switch to window mode":"Switch to center mode",children:p==="center"?t.jsx(Me,{size:14}):t.jsx(Ie,{size:14})}),t.jsx("button",{onClick:ve,className:"p-1.5 text-xs font-medium text-white/80 bg-white/10 hover:bg-red-500/30 hover:text-red-400 rounded-md transition-colors cursor-pointer",title:"Close visualizer",children:t.jsx(Le,{size:14})})]})]}),g&&Ee(),t.jsx("canvas",{ref:Z,width:i.width,height:i.height,className:"w-full h-full"}),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"resize-handle absolute top-0 left-0 w-4 h-4 cursor-nw-resize",onMouseDown:e=>v(e,"nw")}),t.jsx("div",{className:"resize-handle absolute top-0 right-0 w-4 h-4 cursor-ne-resize",onMouseDown:e=>v(e,"ne")}),t.jsx("div",{className:"resize-handle absolute bottom-0 left-0 w-4 h-4 cursor-sw-resize",onMouseDown:e=>v(e,"sw")}),t.jsx("div",{className:"resize-handle absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",onMouseDown:e=>v(e,"se")}),t.jsx("div",{className:"resize-handle absolute top-0 left-4 right-4 h-2 cursor-n-resize",onMouseDown:e=>v(e,"n")}),t.jsx("div",{className:"resize-handle absolute bottom-0 left-4 right-4 h-2 cursor-s-resize",onMouseDown:e=>v(e,"s")}),t.jsx("div",{className:"resize-handle absolute left-0 top-4 bottom-4 w-2 cursor-w-resize",onMouseDown:e=>v(e,"w")}),t.jsx("div",{className:"resize-handle absolute right-0 top-4 bottom-4 w-2 cursor-e-resize",onMouseDown:e=>v(e,"e")})]})]})})}const Ke=Object.freeze(Object.defineProperty({__proto__:null,default:$e},Symbol.toStringTag,{value:"Module"}));export{Ke as V,Je as g};
