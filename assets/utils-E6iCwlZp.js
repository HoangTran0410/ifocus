const g=new WeakMap,l=new Set;function S(e){let t=g.get(e);if(t)return t;const r={alpha:!0,depth:!1,stencil:!1,antialias:!1,preserveDrawingBuffer:!1};return t=e.getContext("webgl2",r)||e.getContext("webgl",r)||e.getContext("experimental-webgl",r),t&&(g.set(e,t),l.add({canvas:e,gl:t}),t.clearColor(0,0,0,0),l.size>6&&console.warn(`[WebGL] WARNING: ${l.size} active WebGL contexts! Risk of context loss.`)),t}const o={glCanvas:null,gl:null,quadBuffer:null,quadSetup:!1};function m(){return o.glCanvas||(o.glCanvas=document.createElement("canvas")),o.glCanvas}function R(e,t){const r=m();return(r.width!==e||r.height!==t)&&(r.width=e,r.height=t),o.gl||(console.log("[WebGL] Creating shared WebGL context"),o.gl=S(r),o.quadSetup=!1,o.gl||console.warn("[WebGL] Failed to create shared WebGL context!")),o.gl!==null}function p(){return o.gl}function L(){const e=o.gl;!e||o.quadSetup||(o.quadBuffer||(o.quadBuffer=e.createBuffer()),e.bindBuffer(e.ARRAY_BUFFER,o.quadBuffer),e.bufferData(e.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),e.STATIC_DRAW),o.quadSetup=!0)}function _(e){const t=o.gl;if(!t||!o.quadBuffer)return;const r=t.getAttribLocation(e,"a_position");t.bindBuffer(t.ARRAY_BUFFER,o.quadBuffer),t.enableVertexAttribArray(r),t.vertexAttribPointer(r,2,t.FLOAT,!1,0,0),t.drawArrays(t.TRIANGLES,0,6)}function h(e,t,r,n){n&&n.length>0&&(r=n.map(u=>`#define ${u}
`).join("")+r);const a=e.createShader(t);return a?(e.shaderSource(a,r),e.compileShader(a),e.getShaderParameter(a,e.COMPILE_STATUS)?a:(console.error("Shader compile error:",e.getShaderInfoLog(a)),e.deleteShader(a),null)):null}function E(e,t,r){const n=h(e,e.VERTEX_SHADER,t),a=h(e,e.FRAGMENT_SHADER,r);return!n||!a?null:b(e,n,a)}function b(e,t,r){const n=e.createProgram();return n?(e.attachShader(n,t),e.attachShader(n,r),e.linkProgram(n),e.getProgramParameter(n,e.LINK_STATUS)?n:(console.error("Program link error:",e.getProgramInfoLog(n)),e.deleteProgram(n),null)):null}function w(e,t){const r={},n=e.getProgramParameter(t,e.ACTIVE_UNIFORMS);for(let a=0;a<n;a++){const i=e.getActiveUniform(t,a);i&&(r[i.name]=e.getUniformLocation(t,i.name))}return r}const P=`
  attribute vec2 a_position;
  varying vec2 v_uv;

  void main() {
    v_uv = a_position * 0.5 + 0.5;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`;function x(e,t,r){t.clearRect(0,0,r.width,r.height),t.drawImage(e,0,0)}function A(e,t,r){let n=0,a=0,i=0;const u=Math.floor(e*6),d=e*6-u,s=r*(1-t),c=r*(1-d*t),f=r*(1-(1-d)*t);switch(u%6){case 0:n=r,a=f,i=s;break;case 1:n=c,a=r,i=s;break;case 2:n=s,a=r,i=f;break;case 3:n=s,a=c,i=r;break;case 4:n=f,a=s,i=r;break;case 5:n=r,a=s,i=c;break}return[n,a,i]}function B(e){if(e.length===0)return 0;let t=0;for(let r=0;r<e.length;r++)t=(t<<5)-t+e.charCodeAt(r)|0;return t}function C(e,t,r){const[n,a,i]=A(e,t,r);return{r:n,g:a,b:i}}function F(){const e=C(Math.random(),1,1);return e.r*=.15,e.g*=.15,e.b*=.15,e}export{P as F,b as a,w as b,h as c,m as d,R as e,E as f,F as g,B as h,L as i,p as j,_ as k,x as l};
