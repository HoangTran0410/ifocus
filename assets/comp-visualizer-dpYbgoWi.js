const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Bars-q2nuBuaC.js","./vendor-7n6RyNsU.js","./comp-audiocontroller-C9_egn6F.js","./comp-background-2KjCJFop.js","./Wave-2l77wxtj.js","./Circular-RTQGu7aD.js","./Spectrum-BRNtdl84.js","./WebGL_Fluid-CSSDlY_D.js","./WebGL_Fiber-Bgpr8Pk_.js"])))=>i.map(i=>d[i]);
import{r as s,j as t,s as ue,t as Te,F as Pe,u as xt,v as _t,w as bt,x as wt,y as vt,X as Et,z as Lt,T as Rt,U as Tt,B as Pt,R as Dt,D as jt}from"./vendor-7n6RyNsU.js";import{u as X}from"./comp-audiocontroller-C9_egn6F.js";import{_ as o,f as yt,g as At,z as De,A as de,B as Ct,C as St,D as It,E as Nt,F as Mt,G as zt,H as Ot,I as Vt,J as Wt,K as Ft}from"./comp-background-2KjCJFop.js";const Ue=new WeakMap,je=new Set;function Gt(r){let n=Ue.get(r);if(n)return n;const a={alpha:!0,depth:!1,stencil:!1,antialias:!1,preserveDrawingBuffer:!1};return n=r.getContext("webgl2",a)||r.getContext("webgl",a)||r.getContext("experimental-webgl",a),n&&(Ue.set(r,n),je.add({canvas:r,gl:n}),n.clearColor(0,0,0,0),je.size>6&&console.warn(`[WebGL] WARNING: ${je.size} active WebGL contexts! Risk of context loss.`)),n}const b={glCanvas:null,gl:null,quadBuffer:null,quadSetup:!1};function qe(){return b.glCanvas||(b.glCanvas=document.createElement("canvas")),b.glCanvas}function kt(r,n){const a=qe();return(a.width!==r||a.height!==n)&&(a.width=r,a.height=n),b.gl||(console.log("[WebGL] Creating shared WebGL context"),b.gl=Gt(a),b.quadSetup=!1,b.gl||console.warn("[WebGL] Failed to create shared WebGL context!")),b.gl!==null}function Xt(){return b.gl}function Ut(){const r=b.gl;!r||b.quadSetup||(b.quadBuffer||(b.quadBuffer=r.createBuffer()),r.bindBuffer(r.ARRAY_BUFFER,b.quadBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),r.STATIC_DRAW),b.quadSetup=!0)}function Yt(r){const n=b.gl;if(!n||!b.quadBuffer)return;const a=n.getAttribLocation(r,"a_position");n.bindBuffer(n.ARRAY_BUFFER,b.quadBuffer),n.enableVertexAttribArray(a),n.vertexAttribPointer(a,2,n.FLOAT,!1,0,0),n.drawArrays(n.TRIANGLES,0,6)}function Ye(r,n,a,m){m&&m.length>0&&(a=m.map(D=>`#define ${D}
`).join("")+a);const u=r.createShader(n);return u?(r.shaderSource(u,a),r.compileShader(u),r.getShaderParameter(u,r.COMPILE_STATUS)?u:(console.error("Shader compile error:",r.getShaderInfoLog(u)),r.deleteShader(u),null)):null}function Bt(r,n,a){const m=Ye(r,r.VERTEX_SHADER,n),u=Ye(r,r.FRAGMENT_SHADER,a);return!m||!u?null:Ht(r,m,u)}function Ht(r,n,a){const m=r.createProgram();return m?(r.attachShader(m,n),r.attachShader(m,a),r.linkProgram(m),r.getProgramParameter(m,r.LINK_STATUS)?m:(console.error("Program link error:",r.getProgramInfoLog(m)),r.deleteProgram(m),null)):null}function qt(r,n){const a={},m=r.getProgramParameter(n,r.ACTIVE_UNIFORMS);for(let u=0;u<m;u++){const g=r.getActiveUniform(n,u);g&&(a[g.name]=r.getUniformLocation(n,g.name))}return a}const $t=`
  attribute vec2 a_position;
  varying vec2 v_uv;

  void main() {
    v_uv = a_position * 0.5 + 0.5;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`;function Kt(r,n,a){n.clearRect(0,0,a.width,a.height),n.drawImage(r,0,0)}function Zt(r,n,a){let m=0,u=0,g=0;const D=Math.floor(r*6),v=r*6-D,j=a*(1-n),G=a*(1-v*n),z=a*(1-(1-v)*n);switch(D%6){case 0:m=a,u=z,g=j;break;case 1:m=G,u=a,g=j;break;case 2:m=j,u=a,g=z;break;case 3:m=j,u=G,g=a;break;case 4:m=z,u=j,g=a;break;case 5:m=a,u=j,g=G;break}return[m,u,g]}function cr(r){if(r.length===0)return 0;let n=0;for(let a=0;a<r.length;a++)n=(n<<5)-n+r.charCodeAt(a)|0;return n}function Jt(r,n,a){const[m,u,g]=Zt(r,n,a);return{r:m,g:u,b:g}}function ur(){const r=Jt(Math.random(),1,1);return r.r*=.15,r.g*=.15,r.b*=.15,r}const fe=new Map,me=512;function Qt(r,n){const{ctx:a,canvas:m,data:u,performanceMode:g=!1,beatIntensity:D=0,bass:v=0,mid:j=0,high:G=0}=r;if(!kt(m.width,m.height))return;const z=qe(),l=Xt();if(!l)return;const U=r.mode||"default";let c=fe.get(U);if(c||(c={program:null,uniforms:{},time:0,audioTexture:null,audioData:null},fe.set(U,c)),!c.program){if(c.program=Bt(l,$t,n),!c.program)return;c.uniforms=qt(l,c.program)}const O=c.uniforms.u_audioData!=null;if(O&&(c.audioTexture||(c.audioTexture=l.createTexture(),c.audioData=new Uint8Array(me*2*4)),c.audioTexture&&c.audioData)){for(let A=0;A<me;A++){const C=Math.floor(A/me*u.length),Y=Math.floor((u[C]||0)*255),S=A*4;c.audioData[S]=Y,c.audioData[S+1]=Y,c.audioData[S+2]=Y,c.audioData[S+3]=255}l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.audioTexture),l.texImage2D(l.TEXTURE_2D,0,l.RGBA,me,2,0,l.RGBA,l.UNSIGNED_BYTE,c.audioData),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MIN_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_MAG_FILTER,l.LINEAR),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_S,l.CLAMP_TO_EDGE),l.texParameteri(l.TEXTURE_2D,l.TEXTURE_WRAP_T,l.CLAMP_TO_EDGE)}if(Ut(),!c.program)return;c.time+=g?.012:.016;const h=u.reduce((A,C)=>A+C,0)/u.length;l.viewport(0,0,l.drawingBufferWidth,l.drawingBufferHeight),l.clearColor(0,0,0,0),l.clear(l.COLOR_BUFFER_BIT),l.useProgram(c.program),l.uniform1f(c.uniforms.u_time,c.time),l.uniform1f(c.uniforms.u_intensity,h),l.uniform1f(c.uniforms.u_beatIntensity,D),l.uniform1f(c.uniforms.u_bass,v),l.uniform1f(c.uniforms.u_mid,j),l.uniform1f(c.uniforms.u_high,G),l.uniform2f(c.uniforms.u_resolution,m.width,m.height),O&&c.audioTexture&&(l.activeTexture(l.TEXTURE0),l.bindTexture(l.TEXTURE_2D,c.audioTexture),l.uniform1i(c.uniforms.u_audioData,0)),l.enable(l.BLEND),l.blendFunc(l.SRC_ALPHA,l.ONE_MINUS_SRC_ALPHA),Yt(c.program),Kt(z,a,m)}function $e(r){if(r===0)fe.clear();else if(typeof r=="string"){const n=fe.get(r);if(!n)return;n.program=null,n.uniforms={}}}const Ce={"ðŸ”§ (Test)":()=>o(()=>import("./FrequencyBands-CYy9ju4N.js"),[],import.meta.url),"ðŸ“Š Bars":()=>o(()=>import("./Bars-q2nuBuaC.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),"ðŸŒŠ Wave":()=>o(()=>import("./Wave-2l77wxtj.js"),__vite__mapDeps([4,1,2,3]),import.meta.url),"ðŸŸ£ Circular":()=>o(()=>import("./Circular-RTQGu7aD.js"),__vite__mapDeps([5,1,2,3]),import.meta.url),"ðŸ”Š TrapNation":()=>o(()=>import("./TrapNation-B6nzrewg.js"),[],import.meta.url),"ðŸŒˆ Spectrum":()=>o(()=>import("./Spectrum-BRNtdl84.js"),__vite__mapDeps([6,1,2,3]),import.meta.url),"âœ¨ Particles":()=>o(()=>import("./Particles-D5t2gMHO.js"),[],import.meta.url),"ðŸ§¬ DnaHelix":()=>o(()=>import("./DnaHelix-ssc88XVj.js"),[],import.meta.url),"ã€°ï¸ Oscilloscope":()=>o(()=>import("./Oscilloscope-D17QgPTu.js"),[],import.meta.url),"ðŸ”† RadialLines":()=>o(()=>import("./RadialLines-BcRsm6sT.js"),[],import.meta.url),"ðŸŒŒ Galaxy":()=>o(()=>import("./Galaxy-i7ixP_Vy.js"),[],import.meta.url),"âš« BlackHole":()=>o(()=>import("./BlackHole-CQSDrsO8.js"),[],import.meta.url),"ðŸ’» Matrix":()=>o(()=>import("./Matrix-GbIVE_cS.js"),[],import.meta.url),"ðŸŽ† Fireworks":()=>o(()=>import("./Fireworks-Btw7m9vA.js"),[],import.meta.url),"ðŸŒ  Aurora":()=>o(()=>import("./Aurora-eR0gUR6a.js"),[],import.meta.url),"ðŸ’ Rings":()=>o(()=>import("./Rings-DgCSEA4s.js"),[],import.meta.url),"ðŸ“ˆ Waveform3D":()=>o(()=>import("./Waveform3D-CKcxO5iK.js"),[],import.meta.url),"â­ Starfield":()=>o(()=>import("./Starfield-BqVxL3YO.js"),[],import.meta.url),"âš›ï¸ Plasma":()=>o(()=>import("./Plasma-TxBw0kFf.js"),[],import.meta.url),"âš¡ Lightning":()=>o(()=>import("./Lightning-ZfCAkrcJ.js"),[],import.meta.url),"ðŸ Hexagons":()=>o(()=>import("./Hexagons-DL83dJF1.js"),[],import.meta.url),"ðŸŒ¿ Fractal":()=>o(()=>import("./Fractal-CrOs2AwR.js"),[],import.meta.url),"ðŸ’§ Fluid (WebGL)":()=>o(()=>import("./WebGL_Fluid-CSSDlY_D.js"),__vite__mapDeps([7,1,2,3]),import.meta.url),"ðŸ•³ï¸ BlackHole (WebGL)":()=>o(()=>import("./WebGL_BlackHole-CgCn8LL6.js"),[],import.meta.url),"ðŸŒ€ Accretion (WebGL)":()=>o(()=>import("./WebGL_Accretion-BIM9kTks.js"),[],import.meta.url),"âš¡ Lightning (WebGL)":()=>o(()=>import("./WebGL_Lightning-DsFB_DjF.js"),[],import.meta.url),"ðŸŒ… Sunset (WebGL)":()=>o(()=>import("./WebGL_Sunset-DZlHUt2l.js"),[],import.meta.url),"ðŸŽ² HoloDice (WebGL)":()=>o(()=>import("./WebGL_HoloDice-DqmOk3zH.js"),[],import.meta.url),"ðŸ“¦ Cube (WebGL)":()=>o(()=>import("./WebGL_Cube-Dj23Vaob.js"),[],import.meta.url),"â˜ï¸ Clouds (WebGL)":()=>o(()=>import("./WebGL_Clouds-DIhS2Hn9.js"),[],import.meta.url),"ðŸŒŒ Universe (WebGL)":()=>o(()=>import("./WebGL_Universe-D0J77Yrn.js"),[],import.meta.url),"âœ¨ Kuko (WebGL)":()=>o(()=>import("./WebGL_Kuko-sPFI5GkG.js"),[],import.meta.url),"ðŸ§µ Fiber (WebGL)":()=>o(()=>import("./WebGL_Fiber-Bgpr8Pk_.js"),__vite__mapDeps([8,1,2,3]),import.meta.url),"âš¡ Zippy (WebGL)":()=>o(()=>import("./WebGL_Zippy-DeGfICcn.js"),[],import.meta.url),"ðŸŽ¨ Art (WebGL)":()=>o(()=>import("./WebGL_Art-qDDGaYAW.js"),[],import.meta.url),"ðŸŒŸ StarNest (WebGL)":()=>o(()=>import("./WebGL_StarNest-DpDPEAgs.js"),[],import.meta.url),"ðŸžï¸ Landscape (WebGL)":()=>o(()=>import("./WebGL_Landscape-Bcb22APO.js"),[],import.meta.url),"ðŸ”¥ Fire (WebGL)":()=>o(()=>import("./WebGL_Fire-ZxZw3sMd.js"),[],import.meta.url),"ðŸ’Ž Fragment (WebGL)":()=>o(()=>import("./WebGL_Fragment-DHpBRSmf.js"),[],import.meta.url),"ðŸª Orbital (WebGL)":()=>o(()=>import("./WebGL_Orbital-Ct4uMVat.js"),[],import.meta.url),"ðŸŽ¨ Palettes (WebGL)":()=>o(()=>import("./WebGL_Palettes-CjFKYfT2.js"),[],import.meta.url),"ðŸ© Torus (WebGL)":()=>o(()=>import("./WebGL_Torus-BcgYzkSV.js"),[],import.meta.url),"ðŸ³ Aqua (WebGL)":()=>o(()=>import("./WebGL_Aqua-CP1_6NCZ.js"),[],import.meta.url),"ðŸ”º Fractal (WebGL)":()=>o(()=>import("./WebGL_FractalPyramid-B1VQRlL_.js"),[],import.meta.url),"ðŸ§Š 4D (WebGL)":()=>o(()=>import("./WebGL_4D-D3WK_BV7.js"),[],import.meta.url),"ðŸ”® Sphere (WebGL)":()=>o(()=>import("./WebGL_Sphere-9FH20SQs.js"),[],import.meta.url),"ðŸ’š Matrix (WebGL)":()=>o(()=>import("./WebGL_Matrix-CnuTdeJ8.js"),[],import.meta.url),"ðŸŒˆ Spectrum (WebGL)":()=>o(()=>import("./WebGL_Spectrum-DCw1_fOU.js"),[],import.meta.url),"ðŸ”¥ Flame (WebGL)":()=>o(()=>import("./WebGL_Flame-JYcLNWR8.js"),[],import.meta.url),"ðŸŒ€ Portal (WebGL)":()=>o(()=>import("./WebGL_Portal-BHgbLwNR.js"),[],import.meta.url),"âš›ï¸ Plasma (WebGL)":()=>o(()=>import("./WebGL_Plasma-B05-xi8I.js"),[],import.meta.url),"ðŸš— Drive (WebGL)":()=>o(()=>import("./WebGL_Drive-_iHZG6CX.js"),[],import.meta.url),"ðŸŒˆ Rainbow (WebGL)":()=>o(()=>import("./WebGL_Rainbow-rcItOx_d.js"),[],import.meta.url),"âœ¡ï¸ Octagram (WebGL)":()=>o(()=>import("./WebGL_Octagram-DudxPa6c.js"),[],import.meta.url),"ðŸ’“ Beat (WebGL)":()=>o(()=>import("./WebGL_Beat-tcf6yLu_.js"),[],import.meta.url),"ðŸ‘ï¸ Eye (WebGL)":()=>o(()=>import("./WebGL_Eye-CJEPQhbs.js"),[],import.meta.url),"ðŸŒŒ Lensing (WebGL)":()=>o(()=>import("./WebGL_Lensing-B8ie-vTY.js"),[],import.meta.url),"ðŸŒ€ Julia (WebGL)":()=>o(()=>import("./WebGL_Julia-Cy8Rp9F0.js"),[],import.meta.url),"ðŸ”„ Inversion (WebGL)":()=>o(()=>import("./WebGL_Inversion-DqW_a9EM.js"),[],import.meta.url),"ðŸŒŠ Liquid (WebGL)":()=>o(()=>import("./WebGL_Liquid-Bag5cvrB.js"),[],import.meta.url)},Ke=Object.keys(Ce),Ze=Ke[1],Be=new Map;let he=null;async function er(r){const n=r==null?void 0:r.mode;he!==null&&he!==n&&$e(he),he=n;let a=Be.get(n);if(!a){const u=await(Ce[n]||Ce[Ze])();if(!u.default)throw new Error(`Invalid render function for mode: ${n}`);a=typeof u.default=="string"?tr(u.default):u.default,Be.set(n,a)}a(r)}function tr(r){return n=>Qt(n,r)}function rr(){$e(0)}const pe=new Map,nr=()=>{pe.clear()},dr=(r,n,a)=>(pe.has(n)||pe.set(n,a()),pe.get(n)),He=/iPhone|iPad|iPod|Android/i;function or(){const[r,n]=s.useState(()=>typeof navigator>"u"?!1:He.test(navigator.userAgent));return s.useEffect(()=>{const a=()=>{const m=He.test(navigator.userAgent),u=window.innerWidth<768;n(m||u)};return a(),window.addEventListener("resize",a),()=>window.removeEventListener("resize",a)},[]),r}const ee=120,te=120,ye=400,Ae=200;function ir({onClose:r,isInPiP:n=!1,forceCenter:a=!1,stop:m=!1}){const u=yt(),g=At(),D=or(),v=a||u==="center",j=s.useRef(null),G=s.useRef(null),z=s.useRef(0),[l,U]=X("zen_visualizer_mode",Ze),[c,O]=X("zen_visualizer_position",{x:50,y:50}),[h,A]=X("zen_visualizer_size",{width:ye,height:Ae}),[C,Y]=s.useState(!1);s.useEffect(()=>{nr()},[h.width,h.height]);const[S,re]=X("zen_visualizer_logo",null),ge=s.useRef(null),[Se,ne]=s.useState(!1),M=s.useRef(null),B=s.useRef(null),[_,H]=s.useState("none"),[Ie,Je]=s.useState(new Set),[Ne,Me]=s.useState(""),[E,oe]=X("zen_visualizer_config",zt()),[q,Qe]=X("zen_visualizer_performance_mode",!1),[$,et]=X("zen_visualizer_show_fps",!1),ze=s.useRef(q);s.useEffect(()=>{ze.current=q},[q]),s.useEffect(()=>{_!=="mode"&&Me(""),_!=="none"&&Je(e=>new Set(e).add(_))},[_]);const Oe=s.useRef(0),xe=s.useRef(0),Ve=s.useRef(performance.now()),We=s.useRef($);s.useEffect(()=>{We.current=$},[$]),s.useEffect(()=>{if(S){const e=new Image;e.onload=()=>{ge.current=e},e.src=S}else ge.current=null},[S]),s.useEffect(()=>{De(E)},[]),s.useEffect(()=>()=>{M.current&&!M.current.closed&&M.current.close()},[]);const tt=s.useCallback(e=>{var d;const i=(d=e.target.files)==null?void 0:d[0];if(i){const f=new FileReader;f.onload=w=>{var T;const R=(T=w.target)==null?void 0:T.result;re(R)},f.readAsDataURL(i)}},[re]),rt=s.useCallback(()=>{re(null)},[re]);s.useCallback(e=>{e.stopPropagation(),U(e.target.value)},[U]);const nt=s.useCallback(e=>{e.stopPropagation(),r==null||r(),rr()},[r]),[k,ie]=s.useState(()=>de()),[y,se]=s.useState(()=>Ct()),_e=s.useRef(null),ot=s.useCallback(async()=>{const e=await St();ie(e),se(e?"tab":"none"),e&&H("none")},[]),it=s.useCallback(async()=>{const e=await It();ie(e),se(e?"mic":"none"),e&&H("none")},[]),st=s.useCallback(async e=>{var d;const i=(d=e.target.files)==null?void 0:d[0];if(i){const f=await Nt(i);ie(f),se(f?"file":"none"),f&&H("none")}_e.current&&(_e.current.value="")},[]),at=s.useCallback(()=>{Ft(),ie(!1),se("none")},[]),lt=s.useCallback(e=>{e.stopPropagation(),H(i=>i==="audio"?"none":"audio")},[]),K=s.useCallback((e,i)=>{const d={...E,[e]:i};oe(d),De({[e]:i})},[E,oe]),ct=s.useCallback(e=>{e.stopPropagation(),H(i=>i==="settings"?"none":"settings")},[]),ut=s.useCallback(e=>{e.stopPropagation();const i=Mt();oe(i),De(i)},[oe]),dt=s.useCallback(async e=>{if(e.stopPropagation(),!window.documentPictureInPicture){alert("Document Picture-in-Picture is not supported in your browser. Please use Chrome 116+ or Edge 116+.");return}if(M.current&&!M.current.closed){M.current.close(),M.current=null,B.current=null,ne(!1);return}try{const i=await window.documentPictureInPicture.requestWindow({width:h.width,height:h.height});M.current=i,i.document.body.style.margin="0",i.document.body.style.padding="0",i.document.body.style.overflow="hidden",i.document.body.style.background="linear-gradient(135deg, rgba(15, 15, 30, 1), rgba(30, 20, 50, 1))";const d=i.document.createElement("canvas");d.width=h.width,d.height=h.height,d.style.width="100%",d.style.height="100%",i.document.body.appendChild(d),B.current=d,i.addEventListener("pagehide",()=>{M.current=null,B.current=null,ne(!1)}),ne(!0)}catch(i){console.error("PiP error:",i),alert("Failed to activate Picture-in-Picture mode. Error: "+i.message),ne(!1)}},[h]),[Z,J]=s.useState(!1),[L,ae]=s.useState(null),[le,Fe]=s.useState(!1),ce=s.useRef({distance:0,width:ye,height:Ae,centerX:0,centerY:0}),I=s.useRef({x:0,y:0,posX:0,posY:0}),p=s.useRef({x:0,y:0,width:ye,height:Ae,posX:0,posY:0}),mt=s.useCallback(e=>{e.target.classList.contains("resize-handle")||(e.preventDefault(),J(!0),I.current={x:e.clientX,y:e.clientY,posX:c.x,posY:c.y})},[c]),ht=s.useCallback(e=>{if(!e.target.classList.contains("resize-handle")&&_==="none"){if(e.touches.length===1){const i=e.touches[0];J(!0),I.current={x:i.clientX,y:i.clientY,posX:c.x,posY:c.y}}else if(e.touches.length===2){e.preventDefault();const i=e.touches[0],d=e.touches[1],f=Math.hypot(d.clientX-i.clientX,d.clientY-i.clientY),w=(i.clientX+d.clientX)/2,R=(i.clientY+d.clientY)/2;Fe(!0),J(!1),ce.current={distance:f,width:h.width,height:h.height,centerX:w,centerY:R}}}},[c,h,_]),be=s.useCallback(e=>{if(Z){const i=e.clientX-I.current.x,d=e.clientY-I.current.y;O({x:I.current.posX+i,y:I.current.posY+d})}else if(L){const i=e.clientX-p.current.x,d=e.clientY-p.current.y;let f=p.current.width,w=p.current.height,R=p.current.posX,T=p.current.posY;if(L.includes("e")&&(f=Math.max(ee,p.current.width+i)),L.includes("w")){const x=p.current.width-i;x>=ee&&(f=x,R=p.current.posX+i)}if(L.includes("s")&&(w=Math.max(te,p.current.height+d)),L.includes("n")){const x=p.current.height-d;x>=te&&(w=x,T=p.current.posY+d)}A({width:f,height:w}),O({x:R,y:T})}},[Z,L,h.width,h.height]),we=s.useCallback(e=>{if(Z&&e.touches.length===1){const i=e.touches[0],d=i.clientX-I.current.x,f=i.clientY-I.current.y;O({x:I.current.posX+d,y:I.current.posY+f})}else if(le&&e.touches.length===2){e.preventDefault();const i=e.touches[0],d=e.touches[1],w=Math.hypot(d.clientX-i.clientX,d.clientY-i.clientY)/ce.current.distance,R=Math.max(ee,Math.round(ce.current.width*w)),T=Math.max(te,Math.round(ce.current.height*w));A({width:R,height:T})}else if(L&&e.touches.length===1){const i=e.touches[0],d=i.clientX-p.current.x,f=i.clientY-p.current.y;let w=p.current.width,R=p.current.height,T=p.current.posX,x=p.current.posY;if(L.includes("e")&&(w=Math.max(ee,p.current.width+d)),L.includes("w")){const N=p.current.width-d;N>=ee&&(w=N,T=p.current.posX+d)}if(L.includes("s")&&(R=Math.max(te,p.current.height+f)),L.includes("n")){const N=p.current.height-f;N>=te&&(R=N,x=p.current.posY+f)}A({width:w,height:R}),O({x:T,y:x})}},[Z,le,L]),ve=s.useCallback(()=>{J(!1),ae(null)},[]),Q=s.useCallback(()=>{J(!1),ae(null),Fe(!1)},[]),V=s.useCallback((e,i)=>{e.preventDefault(),e.stopPropagation(),ae(i),p.current={x:e.clientX,y:e.clientY,width:h.width,height:h.height,posX:c.x,posY:c.y}},[h,c]),W=s.useCallback((e,i)=>{if(e.preventDefault(),e.stopPropagation(),e.touches.length===1){const d=e.touches[0];ae(i),p.current={x:d.clientX,y:d.clientY,width:h.width,height:h.height,posX:c.x,posY:c.y}}},[h,c]);s.useEffect(()=>{if(Z||L||le)return window.addEventListener("mousemove",be),window.addEventListener("mouseup",ve),window.addEventListener("touchmove",we,{passive:!1}),window.addEventListener("touchend",Q),window.addEventListener("touchcancel",Q),()=>{window.removeEventListener("mousemove",be),window.removeEventListener("mouseup",ve),window.removeEventListener("touchmove",we),window.removeEventListener("touchend",Q),window.removeEventListener("touchcancel",Q)}},[Z,L,le,be,ve,we,Q]);const Ee=s.useRef(new Array(64).fill(0)),F=s.useRef(0);s.useEffect(()=>{const e=j.current;if(!e)return;const i=e.getContext("2d");if(!i)return;const d=async()=>{if(m)return;F.current+=.02;let f;if(de())f=Ot();else{for(let P=0;P<Ee.current.length;P++){const gt=.3+(Math.sin(F.current*2+P*.3)*.3+Math.sin(F.current*3.5+P*.5)*.2+Math.sin(F.current*1.2+P*.7)*.25)*.5;Ee.current[P]=Math.max(0,Math.min(1,gt+Math.random()*.1))}f=Ee.current}const w=f.length,R=de()?Vt():Math.sin(F.current*4)*.3+.3,T=de()?Wt():{bass:Math.sin(F.current*1.25)*.3+.4,mid:Math.sin(F.current*1.3)*.25+.35,high:Math.sin(F.current*1.4)*.2+.3};let x=i,N=e;if(B.current){const P=B.current.getContext("2d");P&&(x=P,N=B.current)}if(x.clearRect(0,0,N.width,N.height),await er({ctx:x,canvas:N,data:f,barCount:w,performanceMode:ze.current,logoImage:ge.current,beatIntensity:R,bass:T.bass,mid:T.mid,high:T.high,mode:l}),We.current){x.save(),x.font="bold 12px monospace",x.fillStyle="rgba(255, 255, 255, 0.8)",x.shadowColor="rgba(0, 0, 0, 0.8)",x.shadowBlur=4,x.fillText(`${Oe.current} FPS`,10,20),x.restore(),xe.current++;const P=performance.now(),Re=P-Ve.current;Re>=500&&(Oe.current=Math.round(xe.current*1e3/Re),xe.current=0,Ve.current=P)}z.current=requestAnimationFrame(d)};return d(),()=>{cancelAnimationFrame(z.current)}},[l,m]);const pt=()=>t.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 p-3 mx-2 rounded-lg",style:{background:"rgba(15, 15, 30, 0.7)",border:"1px solid rgba(168, 85, 247, 0.3)",maxHeight:h.height-50,overflowY:"auto"},onMouseDown:e=>e.stopPropagation(),children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:t.jsx("span",{children:"FFT Size"})}),t.jsx("select",{value:E.fftSize,onChange:e=>K("fftSize",parseInt(e.target.value)),className:"w-full px-2 py-1 text-xs bg-white/10 text-white/90 rounded-md border border-white/20 cursor-pointer focus:outline-none focus:border-purple-500",children:[32,64,128,256,512,1024,2048,4096,8192,16384,32768].map(e=>t.jsx("option",{value:e,className:"bg-gray-900",children:e},e))})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Smoothing"}),t.jsx("span",{className:"text-purple-400",children:E.smoothingTimeConstant.toFixed(2)})]}),t.jsx("input",{type:"range",min:"0",max:"0.99",step:"0.01",value:E.smoothingTimeConstant,onChange:e=>K("smoothingTimeConstant",parseFloat(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Min dB"}),t.jsx("span",{className:"text-purple-400",children:E.minDecibels})]}),t.jsx("input",{type:"range",min:"-100",max:"-30",step:"1",value:E.minDecibels,onChange:e=>K("minDecibels",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Max dB"}),t.jsx("span",{className:"text-purple-400",children:E.maxDecibels})]}),t.jsx("input",{type:"range",min:"-50",max:"0",step:"1",value:E.maxDecibels,onChange:e=>K("maxDecibels",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Freq Start"}),t.jsx("span",{className:"text-purple-400",children:E.freqStartIndex})]}),t.jsx("input",{type:"range",min:"0",max:"1024",step:"1",value:E.freqStartIndex,onChange:e=>K("freqStartIndex",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Freq Count"}),t.jsx("span",{className:"text-purple-400",children:E.freqLength})]}),t.jsx("input",{type:"range",min:"5",max:"1024",step:"1",value:E.freqLength,onChange:e=>K("freqLength",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{className:"pt-2 border-t border-white/10",children:[t.jsx("label",{className:"flex justify-between text-xs text-white/70 mb-2",children:t.jsx("span",{children:"Center Logo (Trap Nation)"})}),S?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:S,alt:"Logo preview",className:"w-12 h-12 object-contain rounded bg-white/10"}),t.jsxs("button",{onClick:rt,className:"flex-1 px-3 py-1.5 text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",children:[t.jsx(Rt,{size:14}),"Remove"]})]}):t.jsxs("label",{className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",children:[t.jsx(Tt,{size:14}),"Upload Image",t.jsx("input",{type:"file",accept:"image/*",onChange:tt,className:"hidden"})]})]}),t.jsxs("div",{className:"pt-2 border-t border-white/10",children:[t.jsxs("button",{onClick:()=>Qe(!q),className:`w-full px-3 py-2 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2 ${q?"text-green-400 bg-green-500/20 hover:bg-green-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Performance mode reduces visual effects for better framerate on low-end devices",children:[t.jsx(Pt,{size:14}),"Performance Mode ",q?"ON":"OFF"]}),t.jsxs("button",{onClick:()=>et(!$),className:`w-full mt-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2 ${$?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Show FPS counter on the visualizer",children:["Show FPS ",$?"ON":"OFF"]})]}),t.jsxs("button",{onClick:ut,className:"w-full mt-2 px-3 py-1.5 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",title:"Reset to defaults",children:[t.jsx(Dt,{size:14}),"Reset to Defaults"]})]})}),Le=Ke.filter(e=>e.toLowerCase().includes(Ne.toLowerCase())),Ge=Le.filter(e=>!e.includes("(WebGL)")),ke=Le.filter(e=>e.includes("(WebGL)")),Xe=e=>t.jsx("button",{onClick:()=>{U(e)},className:`px-2 py-2 text-xs font-medium rounded-md transition-all cursor-pointer truncate ${l===e?"text-purple-400 bg-purple-500/30 border border-purple-500/50":"text-white/80 bg-white/10 hover:bg-white/20 border border-transparent"}`,title:e,children:e.replace(" (WebGL)","")},e),ft=()=>t.jsxs("div",{className:"absolute top-10 left-0 right-0 z-20 p-3 mx-2 rounded-lg",style:{background:"rgba(15, 15, 30, 0.9)",border:"1px solid rgba(168, 85, 247, 0.3)",maxHeight:h.height-50,overflowY:"auto"},onMouseDown:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"relative mb-3",children:[t.jsx(jt,{size:14,className:"absolute left-2 top-1/2 -translate-y-1/2 text-white/50"}),t.jsx("input",{type:"text",placeholder:"Search modes...",value:Ne,onChange:e=>Me(e.target.value),className:"w-full pl-7 pr-3 py-1.5 text-xs bg-white/10 text-white/90 rounded-md border border-white/20 focus:outline-none focus:border-purple-500 placeholder:text-white/40",autoFocus:!D})]}),Ge.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2 mt-3 mb-2",children:[t.jsx("div",{className:"h-px flex-1 bg-white/20"}),t.jsx("span",{className:"text-xs text-white/50 font-medium",children:"Simple"}),t.jsx("div",{className:"h-px flex-1 bg-white/20"})]}),t.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:Ge.map(Xe)})]}),ke.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2 mt-3 mb-2",children:[t.jsx("div",{className:"h-px flex-1 bg-white/20"}),t.jsx("span",{className:"text-xs text-white/50 font-medium",children:"WebGL"}),t.jsx("div",{className:"h-px flex-1 bg-white/20"})]}),t.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:ke.map(Xe)})]}),Le.length===0&&t.jsx("div",{className:"text-center text-white/50 text-xs py-4",children:"No modes found"})]});return t.jsx("div",{ref:G,className:`select-none fixed ${v?"":"cursor-move"}`,style:v?{left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:h.width,height:h.height,zIndex:50}:{left:c.x,top:c.y,width:h.width,height:h.height,zIndex:40},onMouseDown:v?void 0:mt,onTouchStart:v?void 0:ht,onMouseEnter:()=>Y(!0),onMouseLeave:()=>Y(!1),children:t.jsxs("div",{className:`relative w-full h-full rounded-2xl overflow-hidden transition-all duration-300 ${v&&!C&&_==="none"?"":"backdrop-blur-md"}`,style:{background:v&&!C&&_==="none"?"transparent":"linear-gradient(135deg, rgba(15, 15, 30, 0.85), rgba(30, 20, 50, 0.85))",border:v&&!C&&_==="none"?"1px solid transparent":"1px solid rgba(168, 85, 247, 0.3)",boxShadow:v&&!C&&_==="none"?"none":"0 8px 32px rgba(0, 0, 0, 0.4), 0 0 60px rgba(168, 85, 247, 0.1)"},children:[t.jsxs("div",{className:`absolute top-0 left-0 right-0 flex items-center justify-between px-3 py-2 z-10 transition-opacity duration-300 ${v&&!C&&_==="none"?"opacity-0":""}`,style:{background:"linear-gradient(180deg, rgba(0,0,0,0.4), transparent)",opacity:C||_!=="none"?1:0},children:[t.jsx("span",{className:"text-xs font-medium text-white/60 uppercase tracking-wider",children:"Visualizer"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs("button",{onClick:lt,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center gap-1 ${k?"text-green-400 bg-green-500/20 hover:bg-green-500/30":_==="audio"?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:k?`Audio: ${y}`:"Select audio source",children:[y==="mic"&&t.jsx(ue,{size:14}),y==="tab"&&t.jsx(Te,{size:14}),y==="file"&&t.jsx(Pe,{size:14}),y==="none"&&t.jsx(ue,{size:14})]}),!n&&!D&&t.jsx("button",{onClick:dt,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${Se?"text-purple-400 bg-purple-500/20 hover:bg-purple-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:Se?"Close PiP":"Open in PiP",children:t.jsx(xt,{size:14})}),t.jsx("button",{onClick:ct,onMouseDown:e=>e.stopPropagation(),className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${_==="settings"?"text-blue-400 bg-blue-500/20 hover:bg-blue-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Audio analyzer settings",children:t.jsx(_t,{size:14})}),t.jsxs("button",{onClick:()=>{H(e=>e==="mode"?"none":"mode")},onMouseDown:e=>e.stopPropagation(),className:`px-2 py-1 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center gap-1.5 ${_==="mode"?"text-purple-400 bg-purple-500/20 hover:bg-purple-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Select visualizer mode",children:[t.jsx(bt,{size:12}),t.jsx("span",{className:"max-w-[80px] truncate",children:l})]}),g&&!a&&t.jsx("button",{onClick:e=>{if(e.stopPropagation(),u==="center"){const i=(window.innerWidth-h.width)/2,d=(window.innerHeight-h.height)/2;O({x:i,y:d})}g(u==="center"?"window":"center")},className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${u==="center"?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:u==="center"?"Switch to window mode":"Switch to center mode",children:u==="center"?t.jsx(wt,{size:14}):t.jsx(vt,{size:14})}),t.jsx("button",{onClick:nt,className:"p-1.5 text-xs font-medium text-white/80 bg-white/10 hover:bg-red-500/30 hover:text-red-400 rounded-md transition-colors cursor-pointer",title:"Close visualizer",children:t.jsx(Et,{size:14})})]})]}),t.jsx("div",{className:_==="settings"?"":"hidden",children:Ie.has("settings")&&pt()}),_==="audio"&&t.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 p-3 mx-2 rounded-lg",style:{background:"rgba(15, 15, 30, 0.9)",border:"1px solid rgba(168, 85, 247, 0.3)"},onMouseDown:e=>e.stopPropagation(),children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"text-xs text-white/60 font-medium mb-2",children:"Select Audio Source"}),k&&t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md bg-green-500/20 border border-green-500/30",children:[t.jsxs("span",{className:"text-xs text-green-400 flex items-center gap-2",children:[y==="mic"&&t.jsx(ue,{size:14}),y==="tab"&&t.jsx(Te,{size:14}),y==="file"&&t.jsx(Pe,{size:14}),y==="tab"&&"Tab Audio",y==="mic"&&"Microphone",y==="file"&&"Audio File"]}),t.jsxs("button",{onClick:at,className:"px-2 py-1 text-xs text-red-400 bg-red-500/20 hover:bg-red-500/30 rounded-md transition-colors flex items-center gap-1",children:[t.jsx(Lt,{size:12}),"Stop"]})]}),!D&&!k&&t.jsxs("button",{onClick:ot,className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors flex items-center gap-2",children:[t.jsx(Te,{size:14}),"Capture Tab Audio"]}),!k&&t.jsxs("button",{onClick:it,className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors flex items-center gap-2",children:[t.jsx(ue,{size:14}),"Use Microphone"]}),!k&&t.jsxs("label",{className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors flex items-center gap-2 cursor-pointer",children:[t.jsx(Pe,{size:14}),"Upload Audio/Video File",t.jsx("input",{ref:_e,type:"file",accept:"audio/*,video/*",onChange:st,className:"hidden"})]}),!k&&t.jsx("p",{className:"text-xs text-white/40 mt-2",children:D?"Tab audio capture is not available on mobile devices.":"Choose how you want to provide audio for the visualizer."})]})}),t.jsx("div",{className:_==="mode"?"":"hidden",children:Ie.has("mode")&&ft()}),t.jsx("canvas",{ref:j,width:h.width,height:h.height,className:"w-full h-full"}),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"resize-handle absolute top-0 left-0 w-4 h-4 cursor-nw-resize",onMouseDown:e=>V(e,"nw"),onTouchStart:e=>W(e,"nw")}),t.jsx("div",{className:"resize-handle absolute top-0 right-0 w-4 h-4 cursor-ne-resize",onMouseDown:e=>V(e,"ne"),onTouchStart:e=>W(e,"ne")}),t.jsx("div",{className:"resize-handle absolute bottom-0 left-0 w-4 h-4 cursor-sw-resize",onMouseDown:e=>V(e,"sw"),onTouchStart:e=>W(e,"sw")}),t.jsx("div",{className:"resize-handle absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",onMouseDown:e=>V(e,"se"),onTouchStart:e=>W(e,"se")}),t.jsx("div",{className:"resize-handle absolute top-0 left-4 right-4 h-2 cursor-n-resize",onMouseDown:e=>V(e,"n"),onTouchStart:e=>W(e,"n")}),t.jsx("div",{className:"resize-handle absolute bottom-0 left-4 right-4 h-2 cursor-s-resize",onMouseDown:e=>V(e,"s"),onTouchStart:e=>W(e,"s")}),t.jsx("div",{className:"resize-handle absolute left-0 top-4 bottom-4 w-2 cursor-w-resize",onMouseDown:e=>V(e,"w"),onTouchStart:e=>W(e,"w")}),t.jsx("div",{className:"resize-handle absolute right-0 top-4 bottom-4 w-2 cursor-e-resize",onMouseDown:e=>V(e,"e"),onTouchStart:e=>W(e,"e")})]})]})})}const mr=Object.freeze(Object.defineProperty({__proto__:null,default:ir},Symbol.toStringTag,{value:"Module"}));export{mr as V,ur as a,Ht as b,Ye as c,qt as d,kt as e,qe as f,dr as g,cr as h,Xt as i};
