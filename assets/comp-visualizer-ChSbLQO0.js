const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Bars-7NW8_zQc.js","./vendor-woyHwGIK.js","./comp-audiocontroller-BNdfcbcW.js","./comp-background-DFWIys4v.js","./Wave-CFXe1mHp.js","./Circular-BYnLtNK6.js","./Spectrum-DVx82J0x.js","./RadialLines-DU1SoB5C.js"])))=>i.map(i=>d[i]);
import{r as s,j as t,s as Te,t as Fe,u as ke,v as Oe,w as Ve,X as He,T as Xe,U as Ye,x as Ue,R as $e}from"./vendor-woyHwGIK.js";import{u as R}from"./comp-audiocontroller-BNdfcbcW.js";import{_ as i,f as qe,g as We,z as G,A as Z,B as Be,C as Ge,D as Ze,E as Je,F as Ke,G as Qe}from"./comp-background-DFWIys4v.js";const J={"ðŸ“Š Bars":()=>i(()=>import("./Bars-7NW8_zQc.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),"ðŸŒŠ Wave":()=>i(()=>import("./Wave-CFXe1mHp.js"),__vite__mapDeps([4,1,2,3]),import.meta.url),"ðŸŸ£ Circular":()=>i(()=>import("./Circular-BYnLtNK6.js"),__vite__mapDeps([5,1,2,3]),import.meta.url),"ðŸ”Š TrapNation":()=>i(()=>import("./TrapNation-DhJT4_Je.js"),[],import.meta.url),"ðŸŒˆ Spectrum":()=>i(()=>import("./Spectrum-DVx82J0x.js"),__vite__mapDeps([6,1,2,3]),import.meta.url),"âœ¨ Particles":()=>i(()=>import("./Particles-BPfqwlbt.js"),[],import.meta.url),"ðŸ§¬ DnaHelix":()=>i(()=>import("./DnaHelix-GrQ9V3EB.js"),[],import.meta.url),"ã€°ï¸ Oscilloscope":()=>i(()=>import("./Oscilloscope-D17QgPTu.js"),[],import.meta.url),"ðŸ”† RadialLines":()=>i(()=>import("./RadialLines-DU1SoB5C.js"),__vite__mapDeps([7,1,2,3]),import.meta.url),"ðŸŒŒ Galaxy":()=>i(()=>import("./Galaxy-BYCvO4Qi.js"),[],import.meta.url),"âš« BlackHole":()=>i(()=>import("./BlackHole-BbqcLKfF.js"),[],import.meta.url),"ðŸ’» Matrix":()=>i(()=>import("./Matrix-CMr4Xaa9.js"),[],import.meta.url),"ðŸŽ† Fireworks":()=>i(()=>import("./Fireworks-BikZ686o.js"),[],import.meta.url),"ðŸŒ  Aurora":()=>i(()=>import("./Aurora-BwSudhWQ.js"),[],import.meta.url),"ðŸ’ Rings":()=>i(()=>import("./Rings-uxHhDKNd.js"),[],import.meta.url),"ðŸ“ˆ Waveform3D":()=>i(()=>import("./Waveform3D-CKcxO5iK.js"),[],import.meta.url),"â­ Starfield":()=>i(()=>import("./Starfield-Cn86jYBA.js"),[],import.meta.url),"ðŸŒ€ Plasma":()=>i(()=>import("./Plasma-Bu5wurn1.js"),[],import.meta.url),"âš¡ Lightning":()=>i(()=>import("./Lightning-CZodbI-H.js"),[],import.meta.url),"ðŸ Hexagons":()=>i(()=>import("./Hexagons-D0qrcvaW.js"),[],import.meta.url),"ðŸŒ¿ Fractal":()=>i(()=>import("./Fractal-BQTGLAV_.js"),[],import.meta.url)},we=Object.keys(J),be=we[0],pe=new Map;async function he(d,z){let p=pe.get(d);if(!p){const h=await(J[d]||J[be])();if(!h.default)throw new Error(`Invalid render function for mode: ${d}`);p=h.default,pe.set(d,p)}p(z)}const H=new Map,et=()=>{H.clear()},ot=(d,z,p)=>(H.has(z)||H.set(z,p()),H.get(z)),me=120,ge=120,xe=400,fe=200;function tt({onClose:d,isInPiP:z=!1,forceCenter:p=!1,stop:X=!1}){const h=qe(),K=We(),m=p||h==="center",Q=s.useRef(null),_e=s.useRef(null),ee=s.useRef(0),[S,te]=R("zen_visualizer_mode",be),[f,Y]=R("zen_visualizer_position",{x:50,y:50}),[o,ve]=R("zen_visualizer_size",{width:xe,height:fe}),[C,re]=s.useState(!1);s.useEffect(()=>{et()},[o.width,o.height]);const[M,A]=R("zen_visualizer_logo",null),T=s.useRef(null),[se,F]=s.useState(!1),g=s.useRef(null),w=s.useRef(null),[x,je]=s.useState(!1),[a,k]=R("zen_visualizer_config",Ze()),[P,ye]=R("zen_visualizer_performance_mode",!1),[D,ze]=R("zen_visualizer_show_fps",!1),U=s.useRef(P);s.useEffect(()=>{U.current=P},[P]);const ne=s.useRef(0),$=s.useRef(0),oe=s.useRef(performance.now()),ie=s.useRef(D);s.useEffect(()=>{ie.current=D},[D]),s.useEffect(()=>{if(M){const e=new Image;e.onload=()=>{T.current=e},e.src=M}else T.current=null},[M]),s.useEffect(()=>{G(a)},[]),s.useEffect(()=>()=>{g.current&&!g.current.closed&&g.current.close()},[]);const Ce=s.useCallback(e=>{var n;const r=(n=e.target.files)==null?void 0:n[0];if(r){const c=new FileReader;c.onload=v=>{var j;const E=(j=v.target)==null?void 0:j.result;A(E)},c.readAsDataURL(r)}},[A]),Ee=s.useCallback(()=>{A(null)},[A]),Re=s.useCallback(e=>{e.stopPropagation(),te(e.target.value)},[te]),Pe=s.useCallback(e=>{e.stopPropagation(),d==null||d()},[d]),[O,ae]=s.useState(()=>Z()),De=s.useCallback(async e=>{if(e.stopPropagation(),O)Qe(),ae(!1);else{const r=await Be();ae(r)}},[O]),N=s.useCallback((e,r)=>{const n={...a,[e]:r};k(n),G({[e]:r})},[a,k]),Ne=s.useCallback(e=>{e.stopPropagation(),je(r=>!r)},[]),Me=s.useCallback(e=>{e.stopPropagation();const r=Ge();k(r),G(r)},[k]),Ie=s.useCallback(async e=>{if(e.stopPropagation(),!window.documentPictureInPicture){alert("Document Picture-in-Picture is not supported in your browser. Please use Chrome 116+ or Edge 116+.");return}if(g.current&&!g.current.closed){g.current.close(),g.current=null,w.current=null,F(!1);return}try{const r=await window.documentPictureInPicture.requestWindow({width:o.width,height:o.height});g.current=r,r.document.body.style.margin="0",r.document.body.style.padding="0",r.document.body.style.overflow="hidden",r.document.body.style.background="linear-gradient(135deg, rgba(15, 15, 30, 1), rgba(30, 20, 50, 1))";const n=r.document.createElement("canvas");n.width=o.width,n.height=o.height,n.style.width="100%",n.style.height="100%",r.document.body.appendChild(n),w.current=n,r.addEventListener("pagehide",()=>{g.current=null,w.current=null,F(!1)}),F(!0)}catch(r){console.error("PiP error:",r),alert("Failed to activate Picture-in-Picture mode. Error: "+r.message),F(!1)}},[o]),[V,le]=s.useState(!1),[b,ce]=s.useState(null),I=s.useRef({x:0,y:0,posX:0,posY:0}),l=s.useRef({x:0,y:0,width:xe,height:fe,posX:0,posY:0}),Le=s.useCallback(e=>{e.target.classList.contains("resize-handle")||(e.preventDefault(),le(!0),I.current={x:e.clientX,y:e.clientY,posX:f.x,posY:f.y})},[f]),q=s.useCallback(e=>{if(V){const r=e.clientX-I.current.x,n=e.clientY-I.current.y;Y({x:I.current.posX+r,y:I.current.posY+n})}else if(b){const r=e.clientX-l.current.x,n=e.clientY-l.current.y;let c=l.current.width,v=l.current.height,E=l.current.posX,j=l.current.posY;if(b.includes("e")&&(c=Math.max(me,l.current.width+r)),b.includes("w")){const y=l.current.width-r;y>=me&&(c=y,E=l.current.posX+r)}if(b.includes("s")&&(v=Math.max(ge,l.current.height+n)),b.includes("n")){const y=l.current.height-n;y>=ge&&(v=y,j=l.current.posY+n)}ve({width:c,height:v}),Y({x:E,y:j})}},[V,b,o.width,o.height]),W=s.useCallback(()=>{le(!1),ce(null)},[]),_=s.useCallback((e,r)=>{e.preventDefault(),e.stopPropagation(),ce(r),l.current={x:e.clientX,y:e.clientY,width:o.width,height:o.height,posX:f.x,posY:f.y}},[o,f]);s.useEffect(()=>{if(V||b)return window.addEventListener("mousemove",q),window.addEventListener("mouseup",W),()=>{window.removeEventListener("mousemove",q),window.removeEventListener("mouseup",W)}},[V,b,q,W]);const B=s.useRef(new Array(64).fill(0)),L=s.useRef(0);s.useEffect(()=>{const e=Q.current;if(!e)return;const r=e.getContext("2d");if(!r)return;const n=async()=>{if(X)return;L.current+=.02;let c;if(Z())c=Je();else{for(let u=0;u<B.current.length;u++){const Ae=.3+(Math.sin(L.current*2+u*.3)*.3+Math.sin(L.current*3.5+u*.5)*.2+Math.sin(L.current*1.2+u*.7)*.25)*.5;B.current[u]=Math.max(0,Math.min(1,Ae+Math.random()*.1))}c=B.current}const v=c.length,E=Z()?Ke():Math.sin(L.current*4)*.3+.3;let j=!1;if(w.current){const u=w.current.getContext("2d");if(u){u.clearRect(0,0,w.current.width,w.current.height);const de={ctx:u,canvas:w.current,data:c,barCount:v,performanceMode:U.current,logoImage:T.current,beatIntensity:E};await he(S,de),j=!0}}if(!j){r.clearRect(0,0,e.width,e.height);const u={ctx:r,canvas:e,data:c,barCount:v,performanceMode:U.current,logoImage:T.current,beatIntensity:E};await he(S,u),ie.current&&(r.save(),r.font="bold 12px monospace",r.fillStyle="rgba(255, 255, 255, 0.8)",r.shadowColor="rgba(0, 0, 0, 0.8)",r.shadowBlur=4,r.fillText(`${ne.current} FPS`,10,20),r.restore())}$.current++;const y=performance.now(),ue=y-oe.current;ue>=1e3&&(ne.current=Math.round($.current*1e3/ue),$.current=0,oe.current=y),ee.current=requestAnimationFrame(n)};return n(),()=>{cancelAnimationFrame(ee.current)}},[S,X]);const Se=()=>t.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 p-3 mx-2 rounded-lg",style:{background:"rgba(15, 15, 30, 0.45)",border:"1px solid rgba(168, 85, 247, 0.3)",maxHeight:o.height-50,overflowY:"auto"},onMouseDown:e=>e.stopPropagation(),children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:t.jsx("span",{children:"FFT Size"})}),t.jsx("select",{value:a.fftSize,onChange:e=>N("fftSize",parseInt(e.target.value)),className:"w-full px-2 py-1 text-xs bg-white/10 text-white/90 rounded-md border border-white/20 cursor-pointer focus:outline-none focus:border-purple-500",children:[32,64,128,256,512,1024,2048,4096,8192,16384,32768].map(e=>t.jsx("option",{value:e,className:"bg-gray-900",children:e},e))})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Smoothing"}),t.jsx("span",{className:"text-purple-400",children:a.smoothingTimeConstant.toFixed(2)})]}),t.jsx("input",{type:"range",min:"0",max:"0.99",step:"0.01",value:a.smoothingTimeConstant,onChange:e=>N("smoothingTimeConstant",parseFloat(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Min dB"}),t.jsx("span",{className:"text-purple-400",children:a.minDecibels})]}),t.jsx("input",{type:"range",min:"-100",max:"-30",step:"1",value:a.minDecibels,onChange:e=>N("minDecibels",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Max dB"}),t.jsx("span",{className:"text-purple-400",children:a.maxDecibels})]}),t.jsx("input",{type:"range",min:"-50",max:"0",step:"1",value:a.maxDecibels,onChange:e=>N("maxDecibels",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Freq Start"}),t.jsx("span",{className:"text-purple-400",children:a.freqStartIndex})]}),t.jsx("input",{type:"range",min:"0",max:"1024",step:"1",value:a.freqStartIndex,onChange:e=>N("freqStartIndex",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Freq Count"}),t.jsx("span",{className:"text-purple-400",children:a.freqLength})]}),t.jsx("input",{type:"range",min:"5",max:"1024",step:"1",value:a.freqLength,onChange:e=>N("freqLength",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{className:"pt-2 border-t border-white/10",children:[t.jsx("label",{className:"flex justify-between text-xs text-white/70 mb-2",children:t.jsx("span",{children:"Center Logo (Trap Nation)"})}),M?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:M,alt:"Logo preview",className:"w-12 h-12 object-contain rounded bg-white/10"}),t.jsxs("button",{onClick:Ee,className:"flex-1 px-3 py-1.5 text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",children:[t.jsx(Xe,{size:14}),"Remove"]})]}):t.jsxs("label",{className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",children:[t.jsx(Ye,{size:14}),"Upload Image",t.jsx("input",{type:"file",accept:"image/*",onChange:Ce,className:"hidden"})]})]}),t.jsxs("div",{className:"pt-2 border-t border-white/10",children:[t.jsxs("button",{onClick:()=>ye(!P),className:`w-full px-3 py-2 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2 ${P?"text-green-400 bg-green-500/20 hover:bg-green-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Performance mode reduces visual effects for better framerate on low-end devices",children:[t.jsx(Ue,{size:14}),"Performance Mode ",P?"ON":"OFF"]}),t.jsxs("button",{onClick:()=>ze(!D),className:`w-full mt-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2 ${D?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Show FPS counter on the visualizer",children:["Show FPS ",D?"ON":"OFF"]})]}),t.jsxs("button",{onClick:Me,className:"w-full mt-2 px-3 py-1.5 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",title:"Reset to defaults",children:[t.jsx($e,{size:14}),"Reset to Defaults"]})]})});return t.jsx("div",{ref:_e,className:`select-none fixed ${m?"":"cursor-move"}`,style:m?{left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:o.width,height:o.height,zIndex:50}:{left:f.x,top:f.y,width:o.width,height:o.height,zIndex:40},onMouseDown:m?void 0:Le,onMouseEnter:()=>re(!0),onMouseLeave:()=>re(!1),children:t.jsxs("div",{className:`relative w-full h-full rounded-2xl overflow-hidden transition-all duration-300 ${m&&!C&&!x?"":"backdrop-blur-md"}`,style:{background:m&&!C&&!x?"transparent":"linear-gradient(135deg, rgba(15, 15, 30, 0.85), rgba(30, 20, 50, 0.85))",border:m&&!C&&!x?"1px solid transparent":"1px solid rgba(168, 85, 247, 0.3)",boxShadow:m&&!C&&!x?"none":"0 8px 32px rgba(0, 0, 0, 0.4), 0 0 60px rgba(168, 85, 247, 0.1)"},children:[t.jsxs("div",{className:`absolute top-0 left-0 right-0 flex items-center justify-between px-3 py-2 z-10 transition-opacity duration-300 ${m&&!C&&!x?"opacity-0":""}`,style:{background:"linear-gradient(180deg, rgba(0,0,0,0.4), transparent)",opacity:m?C||x?1:0:x||C?1:.4},children:[t.jsx("span",{className:"text-xs font-medium text-white/60 uppercase tracking-wider",children:"Visualizer"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:De,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${O?"text-green-400 bg-green-500/20 hover:bg-green-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:O?"Stop audio capture":"Capture tab audio",children:t.jsx(Te,{size:14})}),!z&&t.jsx("button",{onClick:Ie,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${se?"text-purple-400 bg-purple-500/20 hover:bg-purple-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:se?"Close PiP":"Open in PiP",children:t.jsx(Fe,{size:14})}),t.jsx("button",{onClick:Ne,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${x?"text-amber-400 bg-amber-500/20 hover:bg-amber-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Audio analyzer settings",children:t.jsx(ke,{size:14})}),t.jsx("select",{value:S,onChange:Re,onMouseDown:e=>e.stopPropagation(),className:"px-2 py-1 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer border-none focus:outline-none",children:we.map(e=>t.jsx("option",{value:e,className:"bg-gray-900 text-white",children:e},e))}),K&&!p&&t.jsx("button",{onClick:e=>{if(e.stopPropagation(),h==="center"){const r=(window.innerWidth-o.width)/2,n=(window.innerHeight-o.height)/2;Y({x:r,y:n})}K(h==="center"?"window":"center")},className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${h==="center"?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:h==="center"?"Switch to window mode":"Switch to center mode",children:h==="center"?t.jsx(Oe,{size:14}):t.jsx(Ve,{size:14})}),t.jsx("button",{onClick:Pe,className:"p-1.5 text-xs font-medium text-white/80 bg-white/10 hover:bg-red-500/30 hover:text-red-400 rounded-md transition-colors cursor-pointer",title:"Close visualizer",children:t.jsx(He,{size:14})})]})]}),x&&Se(),t.jsx("canvas",{ref:Q,width:o.width,height:o.height,className:"w-full h-full"}),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"resize-handle absolute top-0 left-0 w-4 h-4 cursor-nw-resize",onMouseDown:e=>_(e,"nw")}),t.jsx("div",{className:"resize-handle absolute top-0 right-0 w-4 h-4 cursor-ne-resize",onMouseDown:e=>_(e,"ne")}),t.jsx("div",{className:"resize-handle absolute bottom-0 left-0 w-4 h-4 cursor-sw-resize",onMouseDown:e=>_(e,"sw")}),t.jsx("div",{className:"resize-handle absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",onMouseDown:e=>_(e,"se")}),t.jsx("div",{className:"resize-handle absolute top-0 left-4 right-4 h-2 cursor-n-resize",onMouseDown:e=>_(e,"n")}),t.jsx("div",{className:"resize-handle absolute bottom-0 left-4 right-4 h-2 cursor-s-resize",onMouseDown:e=>_(e,"s")}),t.jsx("div",{className:"resize-handle absolute left-0 top-4 bottom-4 w-2 cursor-w-resize",onMouseDown:e=>_(e,"w")}),t.jsx("div",{className:"resize-handle absolute right-0 top-4 bottom-4 w-2 cursor-e-resize",onMouseDown:e=>_(e,"e")})]})]})})}const it=Object.freeze(Object.defineProperty({__proto__:null,default:tt},Symbol.toStringTag,{value:"Module"}));export{it as V,ot as g};
