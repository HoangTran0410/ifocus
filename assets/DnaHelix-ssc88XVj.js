const w={time:0};function k({ctx:s,canvas:l,data:y,performanceMode:f=!1,beatIntensity:$=0,bass:m=0}){const p=l.width/2,c=l.height/2,S=Math.min(l.height*.3,l.width*.2),P=l.width*.85,C=(l.width-P)/2,g=y.reduce((t,e)=>t+e,0)/y.length;w.time+=.03+g*.02+m*.05;const M=f?50:80,I=1.5,r=[];for(let t=0;t<=M;t++){const e=t/M,o=C+e*P,n=Math.floor(e*y.length),i=y[n]||g,a=e*Math.PI*2*I+w.time,h=S*(.7+i*.4),d=Math.cos(a),z=c+Math.sin(a)*h,b=4+i*5+$*3;r.push({x:o,y:z,z:d,size:b*(.5+(d+1)*.35),intensity:i,strand:0});const u=Math.cos(a+Math.PI),G=c+Math.sin(a+Math.PI)*h,R=4+i*5+$*3;r.push({x:o,y:G,z:u,size:R*(.5+(u+1)*.35),intensity:i,strand:1})}r.sort((t,e)=>t.z-e.z);for(const t of r){const e=(t.z+1)/2,o=t.strand===0?270:320,n=80+e*20,i=35+e*30+t.intensity*15,a=.4+e*.5+t.intensity*.1;if(!f&&t.size>3&&e>.3){const d=t.size*2.5,z=s.createRadialGradient(t.x,t.y,0,t.x,t.y,d);z.addColorStop(0,`hsla(${o}, 100%, 70%, ${e*.25})`),z.addColorStop(1,"transparent"),s.beginPath(),s.arc(t.x,t.y,d,0,Math.PI*2),s.fillStyle=z,s.fill()}const h=s.createRadialGradient(t.x-t.size*.3,t.y-t.size*.3,0,t.x,t.y,t.size);h.addColorStop(0,`hsla(${o}, ${n}%, ${Math.min(90,i+25)}%, ${a})`),h.addColorStop(.5,`hsla(${o}, ${n}%, ${i}%, ${a})`),h.addColorStop(1,`hsla(${o}, ${n}%, ${Math.max(20,i-20)}%, ${a})`),s.beginPath(),s.arc(t.x,t.y,t.size,0,Math.PI*2),s.fillStyle=h,s.fill(),e>.4&&t.size>2&&(s.beginPath(),s.arc(t.x-t.size*.25,t.y-t.size*.25,t.size*.3,0,Math.PI*2),s.fillStyle=`rgba(255, 255, 255, ${.3+e*.4})`,s.fill())}if(!f)for(let t=0;t<2;t++){const e=r.filter(n=>n.strand===t).sort((n,i)=>n.x-i.x);s.beginPath();for(let n=0;n<e.length;n++){const i=e[n];(i.z+1)/2,n===0?s.moveTo(i.x,i.y):s.lineTo(i.x,i.y)}const o=t===0?270:320;s.strokeStyle=`hsla(${o}, 80%, 55%, 0.3)`,s.lineWidth=2,s.stroke()}if(!f){const t=s.createRadialGradient(p,c,0,p,c,S*1.5);t.addColorStop(0,`rgba(168, 85, 247, ${g*.1})`),t.addColorStop(1,"transparent"),s.fillStyle=t,s.fillRect(0,0,l.width,l.height)}}export{k as default};
