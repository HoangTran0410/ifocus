const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./Bars-dLWuwEHI.js","./vendor-7n6RyNsU.js","./comp-audiocontroller-C9_egn6F.js","./comp-background-2KjCJFop.js","./Wave-DdJ4YH38.js","./Circular-CXbTC_gO.js","./Spectrum-Av9VwvFQ.js","./WebGL_Fluid-D8SP6H-p.js","./WebGL_Fiber-E3wF8hh9.js"])))=>i.map(i=>d[i]);
import{r as i,j as t,s as ue,t as Te,F as Pe,u as xt,v as _t,w as bt,x as wt,y as vt,X as Et,z as Rt,T as Lt,U as Tt,B as Pt,R as Dt,D as jt}from"./vendor-7n6RyNsU.js";import{u as X}from"./comp-audiocontroller-C9_egn6F.js";import{_ as c,f as yt,g as At,z as De,A as de,B as Ct,C as St,D as It,E as Nt,F as Mt,G as zt,H as Ot,I as Vt,J as Ft,K as Wt}from"./comp-background-2KjCJFop.js";const Ue=new WeakMap,je=new Set;function Gt(r){let n=Ue.get(r);if(n)return n;const s={alpha:!0,depth:!1,stencil:!1,antialias:!1,preserveDrawingBuffer:!1};return n=r.getContext("webgl2",s)||r.getContext("webgl",s)||r.getContext("experimental-webgl",s),n&&(Ue.set(r,n),je.add({canvas:r,gl:n}),n.clearColor(0,0,0,0),je.size>6&&console.warn(`[WebGL] WARNING: ${je.size} active WebGL contexts! Risk of context loss.`)),n}const b={glCanvas:null,gl:null,quadBuffer:null,quadSetup:!1};function qe(){return b.glCanvas||(b.glCanvas=document.createElement("canvas")),b.glCanvas}function kt(r,n){const s=qe();return(s.width!==r||s.height!==n)&&(s.width=r,s.height=n),b.gl||(console.log("[WebGL] Creating shared WebGL context"),b.gl=Gt(s),b.quadSetup=!1,b.gl||console.warn("[WebGL] Failed to create shared WebGL context!")),b.gl!==null}function Xt(){return b.gl}function Ut(){const r=b.gl;!r||b.quadSetup||(b.quadBuffer||(b.quadBuffer=r.createBuffer()),r.bindBuffer(r.ARRAY_BUFFER,b.quadBuffer),r.bufferData(r.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),r.STATIC_DRAW),b.quadSetup=!0)}function Yt(r){const n=b.gl;if(!n||!b.quadBuffer)return;const s=n.getAttribLocation(r,"a_position");n.bindBuffer(n.ARRAY_BUFFER,b.quadBuffer),n.enableVertexAttribArray(s),n.vertexAttribPointer(s,2,n.FLOAT,!1,0,0),n.drawArrays(n.TRIANGLES,0,6)}function Ye(r,n,s,m){m&&m.length>0&&(s=m.map(D=>`#define ${D}
`).join("")+s);const u=r.createShader(n);return u?(r.shaderSource(u,s),r.compileShader(u),r.getShaderParameter(u,r.COMPILE_STATUS)?u:(console.error("Shader compile error:",r.getShaderInfoLog(u)),r.deleteShader(u),null)):null}function Bt(r,n,s){const m=Ye(r,r.VERTEX_SHADER,n),u=Ye(r,r.FRAGMENT_SHADER,s);return!m||!u?null:Ht(r,m,u)}function Ht(r,n,s){const m=r.createProgram();return m?(r.attachShader(m,n),r.attachShader(m,s),r.linkProgram(m),r.getProgramParameter(m,r.LINK_STATUS)?m:(console.error("Program link error:",r.getProgramInfoLog(m)),r.deleteProgram(m),null)):null}function qt(r,n){const s={},m=r.getProgramParameter(n,r.ACTIVE_UNIFORMS);for(let u=0;u<m;u++){const g=r.getActiveUniform(n,u);g&&(s[g.name]=r.getUniformLocation(n,g.name))}return s}const $t=`
  attribute vec2 a_position;
  varying vec2 v_uv;

  void main() {
    v_uv = a_position * 0.5 + 0.5;
    gl_Position = vec4(a_position, 0.0, 1.0);
  }
`;function Kt(r,n,s){n.clearRect(0,0,s.width,s.height),n.drawImage(r,0,0)}function Zt(r,n,s){let m=0,u=0,g=0;const D=Math.floor(r*6),v=r*6-D,j=s*(1-n),G=s*(1-v*n),z=s*(1-(1-v)*n);switch(D%6){case 0:m=s,u=z,g=j;break;case 1:m=G,u=s,g=j;break;case 2:m=j,u=s,g=z;break;case 3:m=j,u=G,g=s;break;case 4:m=z,u=j,g=s;break;case 5:m=s,u=j,g=G;break}return[m,u,g]}function lr(r){if(r.length===0)return 0;let n=0;for(let s=0;s<r.length;s++)n=(n<<5)-n+r.charCodeAt(s)|0;return n}function Qt(r,n,s){const[m,u,g]=Zt(r,n,s);return{r:m,g:u,b:g}}function ur(){const r=Qt(Math.random(),1,1);return r.r*=.15,r.g*=.15,r.b*=.15,r}const fe=new Map,me=512;function Jt(r,n){const{ctx:s,canvas:m,data:u,performanceMode:g=!1,beatIntensity:D=0,bass:v=0,mid:j=0,high:G=0}=r;if(!kt(m.width,m.height))return;const z=qe(),a=Xt();if(!a)return;const U=r.mode||"default";let l=fe.get(U);if(l||(l={program:null,uniforms:{},time:0,audioTexture:null,audioData:null},fe.set(U,l)),!l.program){if(l.program=Bt(a,$t,n),!l.program)return;l.uniforms=qt(a,l.program)}const O=l.uniforms.u_audioData!=null;if(O&&(l.audioTexture||(l.audioTexture=a.createTexture(),l.audioData=new Uint8Array(me*2*4)),l.audioTexture&&l.audioData)){for(let A=0;A<me;A++){const C=Math.floor(A/me*u.length),Y=Math.floor((u[C]||0)*255),S=A*4;l.audioData[S]=Y,l.audioData[S+1]=Y,l.audioData[S+2]=Y,l.audioData[S+3]=255}a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,l.audioTexture),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,me,2,0,a.RGBA,a.UNSIGNED_BYTE,l.audioData),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE)}if(Ut(),!l.program)return;l.time+=g?.012:.016;const h=u.reduce((A,C)=>A+C,0)/u.length;a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.clearColor(0,0,0,0),a.clear(a.COLOR_BUFFER_BIT),a.useProgram(l.program),a.uniform1f(l.uniforms.u_time,l.time),a.uniform1f(l.uniforms.u_intensity,h),a.uniform1f(l.uniforms.u_beatIntensity,D),a.uniform1f(l.uniforms.u_bass,v),a.uniform1f(l.uniforms.u_mid,j),a.uniform1f(l.uniforms.u_high,G),a.uniform2f(l.uniforms.u_resolution,m.width,m.height),O&&l.audioTexture&&(a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,l.audioTexture),a.uniform1i(l.uniforms.u_audioData,0)),a.enable(a.BLEND),a.blendFunc(a.SRC_ALPHA,a.ONE_MINUS_SRC_ALPHA),Yt(l.program),Kt(z,s,m)}function $e(r){if(r===0)fe.clear();else if(typeof r=="string"){const n=fe.get(r);if(!n)return;n.program=null,n.uniforms={}}}const Ce={"ðŸ”§ (Test)":()=>c(()=>import("./FrequencyBands-CYy9ju4N.js"),[],import.meta.url),"ðŸ“Š Bars":()=>c(()=>import("./Bars-dLWuwEHI.js"),__vite__mapDeps([0,1,2,3]),import.meta.url),"ðŸŒŠ Wave":()=>c(()=>import("./Wave-DdJ4YH38.js"),__vite__mapDeps([4,1,2,3]),import.meta.url),"ðŸŸ£ Circular":()=>c(()=>import("./Circular-CXbTC_gO.js"),__vite__mapDeps([5,1,2,3]),import.meta.url),"ðŸ”Š TrapNation":()=>c(()=>import("./TrapNation-B6nzrewg.js"),[],import.meta.url),"ðŸŒˆ Spectrum":()=>c(()=>import("./Spectrum-Av9VwvFQ.js"),__vite__mapDeps([6,1,2,3]),import.meta.url),"âœ¨ Particles":()=>c(()=>import("./Particles-D5t2gMHO.js"),[],import.meta.url),"ðŸ§¬ DnaHelix":()=>c(()=>import("./DnaHelix-ssc88XVj.js"),[],import.meta.url),"ã€°ï¸ Oscilloscope":()=>c(()=>import("./Oscilloscope-D17QgPTu.js"),[],import.meta.url),"ðŸ”† RadialLines":()=>c(()=>import("./RadialLines-BcRsm6sT.js"),[],import.meta.url),"ðŸŒŒ Galaxy":()=>c(()=>import("./Galaxy-i7ixP_Vy.js"),[],import.meta.url),"âš« BlackHole":()=>c(()=>import("./BlackHole-CQSDrsO8.js"),[],import.meta.url),"ðŸ’» Matrix":()=>c(()=>import("./Matrix-GbIVE_cS.js"),[],import.meta.url),"ðŸŽ† Fireworks":()=>c(()=>import("./Fireworks-Btw7m9vA.js"),[],import.meta.url),"ðŸŒ  Aurora":()=>c(()=>import("./Aurora-eR0gUR6a.js"),[],import.meta.url),"ðŸ’ Rings":()=>c(()=>import("./Rings-DgCSEA4s.js"),[],import.meta.url),"ðŸ“ˆ Waveform3D":()=>c(()=>import("./Waveform3D-CKcxO5iK.js"),[],import.meta.url),"â­ Starfield":()=>c(()=>import("./Starfield-BqVxL3YO.js"),[],import.meta.url),"âš›ï¸ Plasma":()=>c(()=>import("./Plasma-TxBw0kFf.js"),[],import.meta.url),"âš¡ Lightning":()=>c(()=>import("./Lightning-ZfCAkrcJ.js"),[],import.meta.url),"ðŸ Hexagons":()=>c(()=>import("./Hexagons-DL83dJF1.js"),[],import.meta.url),"ðŸŒ¿ Fractal":()=>c(()=>import("./Fractal-CrOs2AwR.js"),[],import.meta.url),"ðŸ’§ Fluid (WebGL)":()=>c(()=>import("./WebGL_Fluid-D8SP6H-p.js"),__vite__mapDeps([7,1,2,3]),import.meta.url),"ðŸ•³ï¸ BlackHole (WebGL)":()=>c(()=>import("./WebGL_BlackHole-CgCn8LL6.js"),[],import.meta.url),"ðŸŒ€ Accretion (WebGL)":()=>c(()=>import("./WebGL_Accretion-BIM9kTks.js"),[],import.meta.url),"âš¡ Lightning (WebGL)":()=>c(()=>import("./WebGL_Lightning-DsFB_DjF.js"),[],import.meta.url),"ðŸŒ… Sunset (WebGL)":()=>c(()=>import("./WebGL_Sunset-DZlHUt2l.js"),[],import.meta.url),"ðŸŽ² HoloDice (WebGL)":()=>c(()=>import("./WebGL_HoloDice-DqmOk3zH.js"),[],import.meta.url),"ðŸ“¦ Cube (WebGL)":()=>c(()=>import("./WebGL_Cube-Dj23Vaob.js"),[],import.meta.url),"â˜ï¸ Clouds (WebGL)":()=>c(()=>import("./WebGL_Clouds-DIhS2Hn9.js"),[],import.meta.url),"ðŸŒŒ Universe (WebGL)":()=>c(()=>import("./WebGL_Universe-D0J77Yrn.js"),[],import.meta.url),"âœ¨ Kuko (WebGL)":()=>c(()=>import("./WebGL_Kuko-sPFI5GkG.js"),[],import.meta.url),"ðŸ§µ Fiber (WebGL)":()=>c(()=>import("./WebGL_Fiber-E3wF8hh9.js"),__vite__mapDeps([8,1,2,3]),import.meta.url),"âš¡ Zippy (WebGL)":()=>c(()=>import("./WebGL_Zippy-DeGfICcn.js"),[],import.meta.url),"ðŸŽ¨ Art (WebGL)":()=>c(()=>import("./WebGL_Art-qDDGaYAW.js"),[],import.meta.url),"ðŸŒŸ StarNest (WebGL)":()=>c(()=>import("./WebGL_StarNest-DpDPEAgs.js"),[],import.meta.url),"ðŸžï¸ Landscape (WebGL)":()=>c(()=>import("./WebGL_Landscape-Bcb22APO.js"),[],import.meta.url),"ðŸ”¥ Fire (WebGL)":()=>c(()=>import("./WebGL_Fire-ZxZw3sMd.js"),[],import.meta.url),"ðŸ’Ž Fragment (WebGL)":()=>c(()=>import("./WebGL_Fragment-DHpBRSmf.js"),[],import.meta.url),"ðŸª Orbital (WebGL)":()=>c(()=>import("./WebGL_Orbital-Ct4uMVat.js"),[],import.meta.url),"ðŸŽ¨ Palettes (WebGL)":()=>c(()=>import("./WebGL_Palettes-CjFKYfT2.js"),[],import.meta.url),"ðŸ© Torus (WebGL)":()=>c(()=>import("./WebGL_Torus-BcgYzkSV.js"),[],import.meta.url),"ðŸ³ Aqua (WebGL)":()=>c(()=>import("./WebGL_Aqua-CP1_6NCZ.js"),[],import.meta.url),"ðŸ”º Fractal (WebGL)":()=>c(()=>import("./WebGL_FractalPyramid-B1VQRlL_.js"),[],import.meta.url),"ðŸ§Š 4D (WebGL)":()=>c(()=>import("./WebGL_4D-D3WK_BV7.js"),[],import.meta.url),"ðŸ”® Sphere (WebGL)":()=>c(()=>import("./WebGL_Sphere-9FH20SQs.js"),[],import.meta.url),"ðŸ’š Matrix (WebGL)":()=>c(()=>import("./WebGL_Matrix-CnuTdeJ8.js"),[],import.meta.url),"ðŸŒˆ Spectrum (WebGL)":()=>c(()=>import("./WebGL_Spectrum-DCw1_fOU.js"),[],import.meta.url),"ðŸ”¥ Flame (WebGL)":()=>c(()=>import("./WebGL_Flame-JYcLNWR8.js"),[],import.meta.url),"ðŸŒ€ Portal (WebGL)":()=>c(()=>import("./WebGL_Portal-BHgbLwNR.js"),[],import.meta.url),"âš›ï¸ Plasma (WebGL)":()=>c(()=>import("./WebGL_Plasma-B05-xi8I.js"),[],import.meta.url),"ðŸš— Drive (WebGL)":()=>c(()=>import("./WebGL_Drive-_iHZG6CX.js"),[],import.meta.url),"ðŸŒˆ Rainbow (WebGL)":()=>c(()=>import("./WebGL_Rainbow-rcItOx_d.js"),[],import.meta.url),"âœ¡ï¸ Octagram (WebGL)":()=>c(()=>import("./WebGL_Octagram-DudxPa6c.js"),[],import.meta.url),"ðŸ’“ Beat (WebGL)":()=>c(()=>import("./WebGL_Beat-tcf6yLu_.js"),[],import.meta.url),"ðŸ‘ï¸ Eye (WebGL)":()=>c(()=>import("./WebGL_Eye-CJEPQhbs.js"),[],import.meta.url),"ðŸŒŒ Lensing (WebGL)":()=>c(()=>import("./WebGL_Lensing-B8ie-vTY.js"),[],import.meta.url)},Ke=Object.keys(Ce),Ze=Ke[1],Be=new Map;let he=null;async function er(r){const n=r==null?void 0:r.mode;he!==null&&he!==n&&$e(he),he=n;let s=Be.get(n);if(!s){const u=await(Ce[n]||Ce[Ze])();if(!u.default)throw new Error(`Invalid render function for mode: ${n}`);s=typeof u.default=="string"?tr(u.default):u.default,Be.set(n,s)}s(r)}function tr(r){return n=>Jt(n,r)}function rr(){$e(0)}const pe=new Map,nr=()=>{pe.clear()},dr=(r,n,s)=>(pe.has(n)||pe.set(n,s()),pe.get(n)),He=/iPhone|iPad|iPod|Android/i;function or(){const[r,n]=i.useState(()=>typeof navigator>"u"?!1:He.test(navigator.userAgent));return i.useEffect(()=>{const s=()=>{const m=He.test(navigator.userAgent),u=window.innerWidth<768;n(m||u)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),r}const ee=120,te=120,ye=400,Ae=200;function ir({onClose:r,isInPiP:n=!1,forceCenter:s=!1,stop:m=!1}){const u=yt(),g=At(),D=or(),v=s||u==="center",j=i.useRef(null),G=i.useRef(null),z=i.useRef(0),[a,U]=X("zen_visualizer_mode",Ze),[l,O]=X("zen_visualizer_position",{x:50,y:50}),[h,A]=X("zen_visualizer_size",{width:ye,height:Ae}),[C,Y]=i.useState(!1);i.useEffect(()=>{nr()},[h.width,h.height]);const[S,re]=X("zen_visualizer_logo",null),ge=i.useRef(null),[Se,ne]=i.useState(!1),M=i.useRef(null),B=i.useRef(null),[_,H]=i.useState("none"),[Ie,Qe]=i.useState(new Set),[Ne,Me]=i.useState(""),[E,oe]=X("zen_visualizer_config",zt()),[q,Je]=X("zen_visualizer_performance_mode",!1),[$,et]=X("zen_visualizer_show_fps",!1),ze=i.useRef(q);i.useEffect(()=>{ze.current=q},[q]),i.useEffect(()=>{_!=="mode"&&Me(""),_!=="none"&&Qe(e=>new Set(e).add(_))},[_]);const Oe=i.useRef(0),xe=i.useRef(0),Ve=i.useRef(performance.now()),Fe=i.useRef($);i.useEffect(()=>{Fe.current=$},[$]),i.useEffect(()=>{if(S){const e=new Image;e.onload=()=>{ge.current=e},e.src=S}else ge.current=null},[S]),i.useEffect(()=>{De(E)},[]),i.useEffect(()=>()=>{M.current&&!M.current.closed&&M.current.close()},[]);const tt=i.useCallback(e=>{var d;const o=(d=e.target.files)==null?void 0:d[0];if(o){const f=new FileReader;f.onload=w=>{var T;const L=(T=w.target)==null?void 0:T.result;re(L)},f.readAsDataURL(o)}},[re]),rt=i.useCallback(()=>{re(null)},[re]);i.useCallback(e=>{e.stopPropagation(),U(e.target.value)},[U]);const nt=i.useCallback(e=>{e.stopPropagation(),r==null||r(),rr()},[r]),[k,ie]=i.useState(()=>de()),[y,se]=i.useState(()=>Ct()),_e=i.useRef(null),ot=i.useCallback(async()=>{const e=await St();ie(e),se(e?"tab":"none"),e&&H("none")},[]),it=i.useCallback(async()=>{const e=await It();ie(e),se(e?"mic":"none"),e&&H("none")},[]),st=i.useCallback(async e=>{var d;const o=(d=e.target.files)==null?void 0:d[0];if(o){const f=await Nt(o);ie(f),se(f?"file":"none"),f&&H("none")}_e.current&&(_e.current.value="")},[]),at=i.useCallback(()=>{Wt(),ie(!1),se("none")},[]),ct=i.useCallback(e=>{e.stopPropagation(),H(o=>o==="audio"?"none":"audio")},[]),K=i.useCallback((e,o)=>{const d={...E,[e]:o};oe(d),De({[e]:o})},[E,oe]),lt=i.useCallback(e=>{e.stopPropagation(),H(o=>o==="settings"?"none":"settings")},[]),ut=i.useCallback(e=>{e.stopPropagation();const o=Mt();oe(o),De(o)},[oe]),dt=i.useCallback(async e=>{if(e.stopPropagation(),!window.documentPictureInPicture){alert("Document Picture-in-Picture is not supported in your browser. Please use Chrome 116+ or Edge 116+.");return}if(M.current&&!M.current.closed){M.current.close(),M.current=null,B.current=null,ne(!1);return}try{const o=await window.documentPictureInPicture.requestWindow({width:h.width,height:h.height});M.current=o,o.document.body.style.margin="0",o.document.body.style.padding="0",o.document.body.style.overflow="hidden",o.document.body.style.background="linear-gradient(135deg, rgba(15, 15, 30, 1), rgba(30, 20, 50, 1))";const d=o.document.createElement("canvas");d.width=h.width,d.height=h.height,d.style.width="100%",d.style.height="100%",o.document.body.appendChild(d),B.current=d,o.addEventListener("pagehide",()=>{M.current=null,B.current=null,ne(!1)}),ne(!0)}catch(o){console.error("PiP error:",o),alert("Failed to activate Picture-in-Picture mode. Error: "+o.message),ne(!1)}},[h]),[Z,Q]=i.useState(!1),[R,ae]=i.useState(null),[ce,We]=i.useState(!1),le=i.useRef({distance:0,width:ye,height:Ae,centerX:0,centerY:0}),I=i.useRef({x:0,y:0,posX:0,posY:0}),p=i.useRef({x:0,y:0,width:ye,height:Ae,posX:0,posY:0}),mt=i.useCallback(e=>{e.target.classList.contains("resize-handle")||(e.preventDefault(),Q(!0),I.current={x:e.clientX,y:e.clientY,posX:l.x,posY:l.y})},[l]),ht=i.useCallback(e=>{if(!e.target.classList.contains("resize-handle")&&_==="none"){if(e.touches.length===1){const o=e.touches[0];Q(!0),I.current={x:o.clientX,y:o.clientY,posX:l.x,posY:l.y}}else if(e.touches.length===2){e.preventDefault();const o=e.touches[0],d=e.touches[1],f=Math.hypot(d.clientX-o.clientX,d.clientY-o.clientY),w=(o.clientX+d.clientX)/2,L=(o.clientY+d.clientY)/2;We(!0),Q(!1),le.current={distance:f,width:h.width,height:h.height,centerX:w,centerY:L}}}},[l,h,_]),be=i.useCallback(e=>{if(Z){const o=e.clientX-I.current.x,d=e.clientY-I.current.y;O({x:I.current.posX+o,y:I.current.posY+d})}else if(R){const o=e.clientX-p.current.x,d=e.clientY-p.current.y;let f=p.current.width,w=p.current.height,L=p.current.posX,T=p.current.posY;if(R.includes("e")&&(f=Math.max(ee,p.current.width+o)),R.includes("w")){const x=p.current.width-o;x>=ee&&(f=x,L=p.current.posX+o)}if(R.includes("s")&&(w=Math.max(te,p.current.height+d)),R.includes("n")){const x=p.current.height-d;x>=te&&(w=x,T=p.current.posY+d)}A({width:f,height:w}),O({x:L,y:T})}},[Z,R,h.width,h.height]),we=i.useCallback(e=>{if(Z&&e.touches.length===1){const o=e.touches[0],d=o.clientX-I.current.x,f=o.clientY-I.current.y;O({x:I.current.posX+d,y:I.current.posY+f})}else if(ce&&e.touches.length===2){e.preventDefault();const o=e.touches[0],d=e.touches[1],w=Math.hypot(d.clientX-o.clientX,d.clientY-o.clientY)/le.current.distance,L=Math.max(ee,Math.round(le.current.width*w)),T=Math.max(te,Math.round(le.current.height*w));A({width:L,height:T})}else if(R&&e.touches.length===1){const o=e.touches[0],d=o.clientX-p.current.x,f=o.clientY-p.current.y;let w=p.current.width,L=p.current.height,T=p.current.posX,x=p.current.posY;if(R.includes("e")&&(w=Math.max(ee,p.current.width+d)),R.includes("w")){const N=p.current.width-d;N>=ee&&(w=N,T=p.current.posX+d)}if(R.includes("s")&&(L=Math.max(te,p.current.height+f)),R.includes("n")){const N=p.current.height-f;N>=te&&(L=N,x=p.current.posY+f)}A({width:w,height:L}),O({x:T,y:x})}},[Z,ce,R]),ve=i.useCallback(()=>{Q(!1),ae(null)},[]),J=i.useCallback(()=>{Q(!1),ae(null),We(!1)},[]),V=i.useCallback((e,o)=>{e.preventDefault(),e.stopPropagation(),ae(o),p.current={x:e.clientX,y:e.clientY,width:h.width,height:h.height,posX:l.x,posY:l.y}},[h,l]),F=i.useCallback((e,o)=>{if(e.preventDefault(),e.stopPropagation(),e.touches.length===1){const d=e.touches[0];ae(o),p.current={x:d.clientX,y:d.clientY,width:h.width,height:h.height,posX:l.x,posY:l.y}}},[h,l]);i.useEffect(()=>{if(Z||R||ce)return window.addEventListener("mousemove",be),window.addEventListener("mouseup",ve),window.addEventListener("touchmove",we,{passive:!1}),window.addEventListener("touchend",J),window.addEventListener("touchcancel",J),()=>{window.removeEventListener("mousemove",be),window.removeEventListener("mouseup",ve),window.removeEventListener("touchmove",we),window.removeEventListener("touchend",J),window.removeEventListener("touchcancel",J)}},[Z,R,ce,be,ve,we,J]);const Ee=i.useRef(new Array(64).fill(0)),W=i.useRef(0);i.useEffect(()=>{const e=j.current;if(!e)return;const o=e.getContext("2d");if(!o)return;const d=async()=>{if(m)return;W.current+=.02;let f;if(de())f=Ot();else{for(let P=0;P<Ee.current.length;P++){const gt=.3+(Math.sin(W.current*2+P*.3)*.3+Math.sin(W.current*3.5+P*.5)*.2+Math.sin(W.current*1.2+P*.7)*.25)*.5;Ee.current[P]=Math.max(0,Math.min(1,gt+Math.random()*.1))}f=Ee.current}const w=f.length,L=de()?Vt():Math.sin(W.current*4)*.3+.3,T=de()?Ft():{bass:Math.sin(W.current*1.25)*.3+.4,mid:Math.sin(W.current*1.3)*.25+.35,high:Math.sin(W.current*1.4)*.2+.3};let x=o,N=e;if(B.current){const P=B.current.getContext("2d");P&&(x=P,N=B.current)}if(x.clearRect(0,0,N.width,N.height),await er({ctx:x,canvas:N,data:f,barCount:w,performanceMode:ze.current,logoImage:ge.current,beatIntensity:L,bass:T.bass,mid:T.mid,high:T.high,mode:a}),Fe.current){x.save(),x.font="bold 12px monospace",x.fillStyle="rgba(255, 255, 255, 0.8)",x.shadowColor="rgba(0, 0, 0, 0.8)",x.shadowBlur=4,x.fillText(`${Oe.current} FPS`,10,20),x.restore(),xe.current++;const P=performance.now(),Le=P-Ve.current;Le>=500&&(Oe.current=Math.round(xe.current*1e3/Le),xe.current=0,Ve.current=P)}z.current=requestAnimationFrame(d)};return d(),()=>{cancelAnimationFrame(z.current)}},[a,m]);const pt=()=>t.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 p-3 mx-2 rounded-lg",style:{background:"rgba(15, 15, 30, 0.7)",border:"1px solid rgba(168, 85, 247, 0.3)",maxHeight:h.height-50,overflowY:"auto"},onMouseDown:e=>e.stopPropagation(),children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:t.jsx("span",{children:"FFT Size"})}),t.jsx("select",{value:E.fftSize,onChange:e=>K("fftSize",parseInt(e.target.value)),className:"w-full px-2 py-1 text-xs bg-white/10 text-white/90 rounded-md border border-white/20 cursor-pointer focus:outline-none focus:border-purple-500",children:[32,64,128,256,512,1024,2048,4096,8192,16384,32768].map(e=>t.jsx("option",{value:e,className:"bg-gray-900",children:e},e))})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Smoothing"}),t.jsx("span",{className:"text-purple-400",children:E.smoothingTimeConstant.toFixed(2)})]}),t.jsx("input",{type:"range",min:"0",max:"0.99",step:"0.01",value:E.smoothingTimeConstant,onChange:e=>K("smoothingTimeConstant",parseFloat(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Min dB"}),t.jsx("span",{className:"text-purple-400",children:E.minDecibels})]}),t.jsx("input",{type:"range",min:"-100",max:"-30",step:"1",value:E.minDecibels,onChange:e=>K("minDecibels",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Max dB"}),t.jsx("span",{className:"text-purple-400",children:E.maxDecibels})]}),t.jsx("input",{type:"range",min:"-50",max:"0",step:"1",value:E.maxDecibels,onChange:e=>K("maxDecibels",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Freq Start"}),t.jsx("span",{className:"text-purple-400",children:E.freqStartIndex})]}),t.jsx("input",{type:"range",min:"0",max:"1024",step:"1",value:E.freqStartIndex,onChange:e=>K("freqStartIndex",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{children:[t.jsxs("label",{className:"flex justify-between text-xs text-white/70 mb-1",children:[t.jsx("span",{children:"Freq Count"}),t.jsx("span",{className:"text-purple-400",children:E.freqLength})]}),t.jsx("input",{type:"range",min:"5",max:"1024",step:"1",value:E.freqLength,onChange:e=>K("freqLength",parseInt(e.target.value)),className:"w-full h-1.5 bg-white/10 rounded-lg appearance-none cursor-pointer accent-purple-500"})]}),t.jsxs("div",{className:"pt-2 border-t border-white/10",children:[t.jsx("label",{className:"flex justify-between text-xs text-white/70 mb-2",children:t.jsx("span",{children:"Center Logo (Trap Nation)"})}),S?t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("img",{src:S,alt:"Logo preview",className:"w-12 h-12 object-contain rounded bg-white/10"}),t.jsxs("button",{onClick:rt,className:"flex-1 px-3 py-1.5 text-xs font-medium text-red-400 bg-red-500/10 hover:bg-red-500/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",children:[t.jsx(Lt,{size:14}),"Remove"]})]}):t.jsxs("label",{className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",children:[t.jsx(Tt,{size:14}),"Upload Image",t.jsx("input",{type:"file",accept:"image/*",onChange:tt,className:"hidden"})]})]}),t.jsxs("div",{className:"pt-2 border-t border-white/10",children:[t.jsxs("button",{onClick:()=>Je(!q),className:`w-full px-3 py-2 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2 ${q?"text-green-400 bg-green-500/20 hover:bg-green-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Performance mode reduces visual effects for better framerate on low-end devices",children:[t.jsx(Pt,{size:14}),"Performance Mode ",q?"ON":"OFF"]}),t.jsxs("button",{onClick:()=>et(!$),className:`w-full mt-2 px-3 py-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2 ${$?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Show FPS counter on the visualizer",children:["Show FPS ",$?"ON":"OFF"]})]}),t.jsxs("button",{onClick:ut,className:"w-full mt-2 px-3 py-1.5 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors cursor-pointer flex items-center justify-center gap-2",title:"Reset to defaults",children:[t.jsx(Dt,{size:14}),"Reset to Defaults"]})]})}),Re=Ke.filter(e=>e.toLowerCase().includes(Ne.toLowerCase())),Ge=Re.filter(e=>!e.includes("(WebGL)")),ke=Re.filter(e=>e.includes("(WebGL)")),Xe=e=>t.jsx("button",{onClick:()=>{U(e)},className:`px-2 py-2 text-xs font-medium rounded-md transition-all cursor-pointer truncate ${a===e?"text-purple-400 bg-purple-500/30 border border-purple-500/50":"text-white/80 bg-white/10 hover:bg-white/20 border border-transparent"}`,title:e,children:e.replace(" (WebGL)","")},e),ft=()=>t.jsxs("div",{className:"absolute top-10 left-0 right-0 z-20 p-3 mx-2 rounded-lg",style:{background:"rgba(15, 15, 30, 0.9)",border:"1px solid rgba(168, 85, 247, 0.3)",maxHeight:h.height-50,overflowY:"auto"},onMouseDown:e=>e.stopPropagation(),children:[t.jsxs("div",{className:"relative mb-3",children:[t.jsx(jt,{size:14,className:"absolute left-2 top-1/2 -translate-y-1/2 text-white/50"}),t.jsx("input",{type:"text",placeholder:"Search modes...",value:Ne,onChange:e=>Me(e.target.value),className:"w-full pl-7 pr-3 py-1.5 text-xs bg-white/10 text-white/90 rounded-md border border-white/20 focus:outline-none focus:border-purple-500 placeholder:text-white/40",autoFocus:!D})]}),Ge.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2 mt-3 mb-2",children:[t.jsx("div",{className:"h-px flex-1 bg-white/20"}),t.jsx("span",{className:"text-xs text-white/50 font-medium",children:"Simple"}),t.jsx("div",{className:"h-px flex-1 bg-white/20"})]}),t.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:Ge.map(Xe)})]}),ke.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs("div",{className:"flex items-center gap-2 mt-3 mb-2",children:[t.jsx("div",{className:"h-px flex-1 bg-white/20"}),t.jsx("span",{className:"text-xs text-white/50 font-medium",children:"WebGL"}),t.jsx("div",{className:"h-px flex-1 bg-white/20"})]}),t.jsx("div",{className:"grid grid-cols-3 gap-1.5",children:ke.map(Xe)})]}),Re.length===0&&t.jsx("div",{className:"text-center text-white/50 text-xs py-4",children:"No modes found"})]});return t.jsx("div",{ref:G,className:`select-none fixed ${v?"":"cursor-move"}`,style:v?{left:"50%",top:"50%",transform:"translate(-50%, -50%)",width:h.width,height:h.height,zIndex:50}:{left:l.x,top:l.y,width:h.width,height:h.height,zIndex:40},onMouseDown:v?void 0:mt,onTouchStart:v?void 0:ht,onMouseEnter:()=>Y(!0),onMouseLeave:()=>Y(!1),children:t.jsxs("div",{className:`relative w-full h-full rounded-2xl overflow-hidden transition-all duration-300 ${v&&!C&&_==="none"?"":"backdrop-blur-md"}`,style:{background:v&&!C&&_==="none"?"transparent":"linear-gradient(135deg, rgba(15, 15, 30, 0.85), rgba(30, 20, 50, 0.85))",border:v&&!C&&_==="none"?"1px solid transparent":"1px solid rgba(168, 85, 247, 0.3)",boxShadow:v&&!C&&_==="none"?"none":"0 8px 32px rgba(0, 0, 0, 0.4), 0 0 60px rgba(168, 85, 247, 0.1)"},children:[t.jsxs("div",{className:`absolute top-0 left-0 right-0 flex items-center justify-between px-3 py-2 z-10 transition-opacity duration-300 ${v&&!C&&_==="none"?"opacity-0":""}`,style:{background:"linear-gradient(180deg, rgba(0,0,0,0.4), transparent)",opacity:C||_!=="none"?1:0},children:[t.jsx("span",{className:"text-xs font-medium text-white/60 uppercase tracking-wider",children:"Visualizer"}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs("button",{onClick:ct,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center gap-1 ${k?"text-green-400 bg-green-500/20 hover:bg-green-500/30":_==="audio"?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:k?`Audio: ${y}`:"Select audio source",children:[y==="mic"&&t.jsx(ue,{size:14}),y==="tab"&&t.jsx(Te,{size:14}),y==="file"&&t.jsx(Pe,{size:14}),y==="none"&&t.jsx(ue,{size:14})]}),!n&&!D&&t.jsx("button",{onClick:dt,className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${Se?"text-purple-400 bg-purple-500/20 hover:bg-purple-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:Se?"Close PiP":"Open in PiP",children:t.jsx(xt,{size:14})}),t.jsx("button",{onClick:lt,onMouseDown:e=>e.stopPropagation(),className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${_==="settings"?"text-blue-400 bg-blue-500/20 hover:bg-blue-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Audio analyzer settings",children:t.jsx(_t,{size:14})}),t.jsxs("button",{onClick:()=>{H(e=>e==="mode"?"none":"mode")},onMouseDown:e=>e.stopPropagation(),className:`px-2 py-1 text-xs font-medium rounded-md transition-colors cursor-pointer flex items-center gap-1.5 ${_==="mode"?"text-purple-400 bg-purple-500/20 hover:bg-purple-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:"Select visualizer mode",children:[t.jsx(bt,{size:12}),t.jsx("span",{className:"max-w-[80px] truncate",children:a})]}),g&&!s&&t.jsx("button",{onClick:e=>{if(e.stopPropagation(),u==="center"){const o=(window.innerWidth-h.width)/2,d=(window.innerHeight-h.height)/2;O({x:o,y:d})}g(u==="center"?"window":"center")},className:`p-1.5 text-xs font-medium rounded-md transition-colors cursor-pointer ${u==="center"?"text-cyan-400 bg-cyan-500/20 hover:bg-cyan-500/30":"text-white/80 bg-white/10 hover:bg-white/20"}`,title:u==="center"?"Switch to window mode":"Switch to center mode",children:u==="center"?t.jsx(wt,{size:14}):t.jsx(vt,{size:14})}),t.jsx("button",{onClick:nt,className:"p-1.5 text-xs font-medium text-white/80 bg-white/10 hover:bg-red-500/30 hover:text-red-400 rounded-md transition-colors cursor-pointer",title:"Close visualizer",children:t.jsx(Et,{size:14})})]})]}),t.jsx("div",{className:_==="settings"?"":"hidden",children:Ie.has("settings")&&pt()}),_==="audio"&&t.jsx("div",{className:"absolute top-10 left-0 right-0 z-20 p-3 mx-2 rounded-lg",style:{background:"rgba(15, 15, 30, 0.9)",border:"1px solid rgba(168, 85, 247, 0.3)"},onMouseDown:e=>e.stopPropagation(),children:t.jsxs("div",{className:"space-y-2",children:[t.jsx("div",{className:"text-xs text-white/60 font-medium mb-2",children:"Select Audio Source"}),k&&t.jsxs("div",{className:"flex items-center justify-between p-2 rounded-md bg-green-500/20 border border-green-500/30",children:[t.jsxs("span",{className:"text-xs text-green-400 flex items-center gap-2",children:[y==="mic"&&t.jsx(ue,{size:14}),y==="tab"&&t.jsx(Te,{size:14}),y==="file"&&t.jsx(Pe,{size:14}),y==="tab"&&"Tab Audio",y==="mic"&&"Microphone",y==="file"&&"Audio File"]}),t.jsxs("button",{onClick:at,className:"px-2 py-1 text-xs text-red-400 bg-red-500/20 hover:bg-red-500/30 rounded-md transition-colors flex items-center gap-1",children:[t.jsx(Rt,{size:12}),"Stop"]})]}),!D&&!k&&t.jsxs("button",{onClick:ot,className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors flex items-center gap-2",children:[t.jsx(Te,{size:14}),"Capture Tab Audio"]}),!k&&t.jsxs("button",{onClick:it,className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors flex items-center gap-2",children:[t.jsx(ue,{size:14}),"Use Microphone"]}),!k&&t.jsxs("label",{className:"w-full px-3 py-2 text-xs font-medium text-white/80 bg-white/10 hover:bg-white/20 rounded-md transition-colors flex items-center gap-2 cursor-pointer",children:[t.jsx(Pe,{size:14}),"Upload Audio/Video File",t.jsx("input",{ref:_e,type:"file",accept:"audio/*,video/*",onChange:st,className:"hidden"})]}),!k&&t.jsx("p",{className:"text-xs text-white/40 mt-2",children:D?"Tab audio capture is not available on mobile devices.":"Choose how you want to provide audio for the visualizer."})]})}),t.jsx("div",{className:_==="mode"?"":"hidden",children:Ie.has("mode")&&ft()}),t.jsx("canvas",{ref:j,width:h.width,height:h.height,className:"w-full h-full"}),t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"resize-handle absolute top-0 left-0 w-4 h-4 cursor-nw-resize",onMouseDown:e=>V(e,"nw"),onTouchStart:e=>F(e,"nw")}),t.jsx("div",{className:"resize-handle absolute top-0 right-0 w-4 h-4 cursor-ne-resize",onMouseDown:e=>V(e,"ne"),onTouchStart:e=>F(e,"ne")}),t.jsx("div",{className:"resize-handle absolute bottom-0 left-0 w-4 h-4 cursor-sw-resize",onMouseDown:e=>V(e,"sw"),onTouchStart:e=>F(e,"sw")}),t.jsx("div",{className:"resize-handle absolute bottom-0 right-0 w-4 h-4 cursor-se-resize",onMouseDown:e=>V(e,"se"),onTouchStart:e=>F(e,"se")}),t.jsx("div",{className:"resize-handle absolute top-0 left-4 right-4 h-2 cursor-n-resize",onMouseDown:e=>V(e,"n"),onTouchStart:e=>F(e,"n")}),t.jsx("div",{className:"resize-handle absolute bottom-0 left-4 right-4 h-2 cursor-s-resize",onMouseDown:e=>V(e,"s"),onTouchStart:e=>F(e,"s")}),t.jsx("div",{className:"resize-handle absolute left-0 top-4 bottom-4 w-2 cursor-w-resize",onMouseDown:e=>V(e,"w"),onTouchStart:e=>F(e,"w")}),t.jsx("div",{className:"resize-handle absolute right-0 top-4 bottom-4 w-2 cursor-e-resize",onMouseDown:e=>V(e,"e"),onTouchStart:e=>F(e,"e")})]})]})})}const mr=Object.freeze(Object.defineProperty({__proto__:null,default:ir},Symbol.toStringTag,{value:"Module"}));export{mr as V,ur as a,Ht as b,Ye as c,qt as d,kt as e,qe as f,dr as g,lr as h,Xt as i};
